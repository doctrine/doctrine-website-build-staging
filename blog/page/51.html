<!DOCTYPE html>
<html>
    <head>
        <title>Blog - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?3625e4" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
            </head>
    <body>
                    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu projects-dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/lexer/">Lexer</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="search-results rounded">
                    <div id="hits">
                        <!-- Hits widget will appear here -->
                    </div>

                    <a href="https://www.algolia.com" target="_blank"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
                </div>
            </nav>
        
            <main role="main" class="container-wrapper container">
                        <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/03/15/what-to-expect-from-doctrine-1.html">What to expect from Doctrine 1</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-03-15
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            <p>As you all can obviously see, our focus around here these days has been
on Doctrine 2. While overall this is a great thing, we still have a
stable Doctrine 1.2 version to maintain. This blog post will give you a
little information about Doctrine 1.0, 1.1 and 1.2.</p>

<h1 id="doctrine-1.0-and-1.1-end-of-life">Doctrine 1.0 and 1.1 End of Life</h1>

<p>You may not have noticed, but the end of life for Doctrine 1.0 and 1.1
has come and gone earlier in the year. As of right now we will not be
committing anymore bug fixes to these branches. All development
resources will now focus on finishing Doctrine 2 and maintaining 1.2.</p>

<h1 id="doctrine-1.2-maintenance-releases">Doctrine 1.2 Maintenance Releases</h1>

<p>Since Doctrine 1.2 is the last stable version to be released for the
Doctrine 1 series, we decided to open up the development a little bit
for the maintenance releases. Previously we were very strict with only
allowing bug fixes, but we will now allow a little more flexibility to
the types of things we commit to these releases. They can now contain
small enhancements and improvements as long as they do not break
backwards compatibility. Of course when adding things we cannot always
be 100% sure that something is BC, so we will announce each 1.2.x
release one week prior to it's packaging and deployment in order to give
people time to test things in SVN.</p>

<p>The reasoning behind this move is because we want to still improve the
small usability issues of the Doctrine 1 series without having to commit
to entirely new major versions. This way we are not leaving the Doctrine
1 code behind while we're focusing on the Doctrine 2 version. We hope
that you all are okay with this move. If you have any issues please let
us know!</p>

        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/03/15/doctrine-2-at-confoo-2010.html">Doctrine 2 at ConFoo 2010</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-03-15
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            <p>This past week I was lucky enough to get to travel to Montreal for the
annual ConFoo conference, previously known as PHP Quebec. I presented on
the latest and greatest version of Doctrine, 2.0 for the PHP Trac. You
can find the slides on SlideShare.com
<a href="http://www.slideshare.net/jwage/doctrine-2-enterprise-persistence-layer-for-php-3402070">here</a>
or view the presentation embedded below:</p>

<div style="margin-left: 30px; width:425px" id="__ss_3402070">

Doctrine 2 - Enterprise Persistence Layer For PHP

<object width="425" height="355">

</object><div style="padding:5px 0 12px">

View more presentations from Jonathan Wage.

</div></div>

        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/03/13/doctrine2-validations.html">Validation of Doctrine 2 Entities</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-03-13
                            by
                                    beberlei
                                    </p>

        <hr />

        <div>
            <p>While Doctrine 1 had validation nested inside the <code>Doctrine_Record</code>
instance this is not the case in Doctrine 2 anymore. We won't ship
Doctrine 2 with any validators, the reason being that we think all the
frameworks out there already ship with quite decents ones that can be
integrated into your Domain easily. Besides us being ORM experts not
wanting to maintain yet another validation library, moving the
responsibility of validation into the domain layer also allows you to
integrate it much easier into frameworks form libraries for example.</p>

<p>What we do offer are hooks to execute any kind of validation inside the
Doctrine ORM.</p>

<p>Entities can register lifecycle event methods with Doctrine that are
called on different occasions. For validation we would need to hook into
the events called before persisting and updating. Even though we don't
support validation out of the box, the implementation is even simpler
than in Doctrine 1 and you will get the additional benefit of being able
to re-use your validation in any other part of your domain.</p>

<p>Say we have an <code>Order</code> with several <code>OrderLine</code> instances. We never want
to allow any customer to order for a larger sum than he is allowed to:</p>

<pre><code class="sourceCode php">&lt;?php
class Order
{
    public function assertCustomerAllowedBuying()
    {
        $orderLimit = $this-&gt;customer-&gt;getOrderLimit();

        $amount = 0;
        foreach ($this-&gt;orderLines AS $line) {
            $amount += $line-&gt;getAmount();
        }

        if ($amount &gt; $orderLimit) {
            throw new CustomerOrderLimitExceededException();
        }
    }
}
</code></pre>

<p>Now this is some pretty important piece of business logic in your code,
enforcing it at any time is important so that customers with a unknown
reputation don't owe your business too much money.</p>

<p>We can enforce this constraint in any of the metadata drivers. First
Annotations:</p>

<pre><code class="sourceCode php">&lt;?php
/**
 * @Entity
 * @HasLifecycleCallbacks
 */
class Order
{
    /**
     * @PrePersist @PreUpdate
     */
    public function assertCustomerAllowedBuying() {}
}
</code></pre>

<p>In XML Mappings:</p>

<pre><code>[xml]
&lt;doctrine-mapping&gt;
    &lt;entity name="Order"&gt;
        &lt;lifecycle-callbacks&gt;
            &lt;lifecycle-callback type="prePersist" method="assertCustomerAllowedBuying" /&gt;
            &lt;lifecycle-callback type="preUpdate" method="assertCustomerAllowedBuying" /&gt;
        &lt;/lifecycle-callbacks&gt;
    &lt;/entity&gt;
&lt;/doctirne-mapping&gt;
</code></pre>

<p>YAML needs some little change yet, to allow multiple lifecycle events
for one method, this will happen before Beta 1 though.</p>

<p>Now validation is performed whenever you call
<code>EntityManager#persist($order)</code> or when you call <code>EntityManager#flush()</code>
and an order is about to be updated. Any Exception that happens in the
lifecycle callbacks will be catched by the EntityManager and the current
transaction is rolled back.</p>

<p>Of course you can do any type of primitive checks, not null,
email-validation, string size, integer and date ranges in your
validation callbacks.</p>

<pre><code class="sourceCode php">&lt;?php
class Order
{
    /**
     * @PrePersist @PreUpdate
     */
    public function validate()
    {
        if (!($this-&gt;plannedShipDate instanceof DateTime)) {
            throw new ValidateException();
        }

        if ($this-&gt;plannedShipDate-&gt;format('U') &lt; time()) {
            throw new ValidateException();
        }

        if ($this-&gt;customer == null) {
            throw new OrderRequiresCustomerException();
        }
    }
}
</code></pre>

<p>What is nice about lifecycle events is, you can also re-use the methods
at other places in your domain, for example in combination with your
form library. Additionally there is no limitation in the number of
methods you register on one particular event, i.e. you can register
multiple methods for validation in "PrePersist" or "PreUpdate" or mix
and share them in any combinations between those two events.</p>

<p>There is no limit to what you can and can't validate in "PrePersist" and
"PreUpdate" aslong as you don't create new entity instances. This was
already discussed in the previous blog post on the Versionable
extension, which requires another type of event called "onFlush".</p>

<p>Also read:</p>

<ul>
<li><a href="http://www.doctrine-project.org/documentation/manual/2_0/en/events#lifecycle-events">Doctrine 2 Manual:
Events</a></li>
<li><a href="http://www.doctrine-project.org/blog/doctrine2-versionable">Doctrine 2 Blog: A reusable Versionable
Behaviour</a></li>
</ul>

        </div>

            </article>

    <nav class="mt-4">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/50.html">Newer Posts</a></li><br />
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/52.html">Older Posts</a></li>        </ul>
    </nav>
            </main>

        
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://staging.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?f32c09"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?36322d"></script>

        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            new Main();

            new Search(projectSlug, versionSlug);
        </script>

        
        
        
            </body>
</html>
