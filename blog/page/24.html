<!DOCTYPE html>
<html>
    <head>
        <title>Blog - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?3625e4" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
            </head>
    <body>
                    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu projects-dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/lexer/">Lexer</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="search-results rounded">
                    <div id="hits">
                        <!-- Hits widget will appear here -->
                    </div>

                    <a href="https://www.algolia.com" target="_blank"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
                </div>
            </nav>
        
            <main role="main" class="container-wrapper container">
                        <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2013/12/23/our-hhvm-roadmap.html">Our HHVM Roadmap</a></h2>
        </header>

        <p class="lead">
            Posted on 2013-12-23
                            by
                                    Benjamin Eberlei
                                    </p>

        <hr />

        <div>
            Facebook has been `pushing HHVM alot lately
<http://www.hhvm.com/blog/2813/we-are-the-98-5-and-the-16>`_ , helping open
source projects to get their test-suite running 100%. For Doctrine HHVM is
particularly interesting, because of the performance gains that the complex PHP
algorithms inside ORM would probably get. From my current feeling Doctrine will
be the PHP open-source project getting the most gain from running on HHVM.
However with the tests not yet passing on the ORM, we can only imagine how big
that performance improvement will be.

One roadblock for us to investigate HHVM in more detail was missing CI support.
But then Travis CI `announced support for HHVM
<http://about.travis-ci.org/blog/2013-12-16-test-php-code-with-the-hiphop-vm>`_
last week. With automated testing support available we think it is time to
announce our official HHVM roadmap.

One of our goals for 2014 is running DBAL and ORM on HHVM with 100% of the
testsuites passing. Every Doctrine subproject targeting to support HHVM will
start running the tests against HHVM with ``allow_failure`` enabled on Travis
CI. Whenever a Doctrine subproject passes all its tests on HHVM, we will
remove the ``allow_failure`` and the project will be officially supporting HHVM
from that version on.

So far we have been working on the Common projects to run on HHVM for several
months now and Guilherme and Alexander are contributing to HHVM itself to get
some missing APIs working. We are happy to announce that the following Common
projects currently have full HHVM support from us:

- `Collections <https://travis-ci.org/doctrine/collections>`_
- `Inflector <https://travis-ci.org/doctrine/inflector>`_
- `Lexer <https://travis-ci.org/doctrine/lexer>`_

Guilherme is working on getting `Annotations
<https://travis-ci.org/doctrine/annotations>`_ and `Cache
<https://travis-ci.org/doctrine/cache>`_ working and the `Common
<https://travis-ci.org/doctrine/common>`_ mainproject will be evaluated shortly
after all the common projects succeed. `DBAL
<https://travis-ci.org/doctrine/dbal>`_ and `ORM
<https://travis-ci.org/doctrine/doctrine2>`_ will be much more work, but we are
very confident to achieve this goal.

If you want to help us with this goal, you can check the current Travis failure
reports of the projects and come up with ideas how to fix them in the Doctrine
code or with bug reports for HHVM. We are glad to discuss these issues on
Freenode IRC in channel "#doctrine-dev".

With this announcement we hope that other PHP projects, frameworks and
libraries will follow to make HHVM an official build target in the future.
        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2013/11/12/doctrine-2-4-1.html">Doctrine 2.4.1 released</a></h2>
        </header>

        <p class="lead">
            Posted on 2013-11-12
                            by
                                    Benjamin Eberlei
                                    </p>

        <hr />

        <div>
            Today we released Doctrine DBAL 2.4.1 and ORM 2.4.1 versions.
It includes an important fix for a regression with array hydration.
In total 6 tickets have been closed in both releases.

See all the changes:

- `Doctrine ORM v2.4.1 Changelog
  <http://www.doctrine-project.org/jira/browse/DDC/fixforversion/10528>`_
- `Doctrine DBAL v2.4.1 Changelog
  <http://www.doctrine-project.org/jira/browse/DBAL/fixforversion/10527>`_

Installation
------------

You can install Doctrine using Composer and the following ``composer.json``
contents:

.. code-block:: json

    {
        "require": {
            "doctrine/common": "2.4.*",
            "doctrine/dbal": "2.4.1",
            "doctrine/orm": "2.4.1"
        }
    }
        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2013/09/25/phpcr-odm-qbv2.html">PHPCR ODM QueryBuilder v2</a></h2>
        </header>

        <p class="lead">
            Posted on 2013-09-25
                            by
                                    dantleech
                                    </p>

        <hr />

        <div>
            managed to merge the new query builder.

I developed the original query builder about 9 months ago - it was one of my
first contributions to the PHPCR-ODM doctrine project. It was heavily based on
the ORM query builder and the consensus being that we should make the ODM as
intuitive as possible for existing ORM users.

Abstracting PHPCR to fit the existing interface worked up until a point, we
could implement the *basic* functionality of the ORM Query Builder exactly,
things started to come undone when we looked at implementing joins.

I had added the joins in the API but didn't get around to implementing them, the
methods just threw "not implemented" exceptions. Later, when we wanted to
implement them, it wasn't so simple. Infact, upon closer inspection, many of
the things available in the PHPCR API's Query Object Model interface were not
covered by the model of the query builder we had chosen, in short, it was not
fit for purpose. I expounded this on the following wiki page:

* https://github.com/symfony-cmf/symfony-cmf/wiki/Query-Builder-v2

As detailed in the above linked page, it seemed to me that either we
implemented a 2 part factory heavy query builder or a fluent node based query
builder. The node based design won. However, at the time I never imagined it
would take so long to write! So nearly 2 months later here we are.

Some features of the new query builder

* Can fully express the PHPCR QOM (Query Object Model).
* Features a fluent interface.
* Strict validation and helpful exception messages.
* Less verbose than the PHPCR QOM model.

Lets compare a PHPCR QOM query with its new query builder counterpart:

The following two examples are equivalent and both select a blog posts with node
name "My Post Title" having the ODM class "Blog\Post". We order the result set
first by publishing date and then by title.

Using the PHPCR QOM:

.. code-block:: php

    <?php
    $q = $qom->createQuery(
        // SourceInterface (from)
        $qom->selector('nt:unstructured', 'p')
        $qom->andConstraint(
            $qom->comparison(
                $qom->propertyValue('p', 'phpcr:class'),
                $qom->bindVariableValue('phpcr_class'),
                QueryObjectModelInterface::JCR_OPERATOR_EQUAL_TO
            ),
            $qom->comparison(
                $qom->nodeLocalName('p'),
                $qom->bindVariableValue('post_title'),
                QueryObjectModelInterface::JCR_OPERATOR_EQUAL_TO
            ),
            array(
                $qom->ascending($qom->propertyValue('published_on', 'p'))
                $qom->ascending($qom->propertyValue('title', 'p'))
            )
        )
    );
    $q->bindValue('phpcr_class', 'Blog\Post');
    $q->bindValue('post_title', 'My Post Title');
    $res = $q->execute();

Using the new PHPCR-ODM query builder:

.. code-block:: php

    <?php
    $q = $documentManager->createQueryBuilder()
        ->fromDocument('Blog\Post', 'p')
        ->where()
            ->eq()->field('p.title')->parameter('post_title')->end()
        ->end()
        ->orderBy()
            ->asc()->field('p.published_on')->end()
            ->asc()->field('p.title')->end()
        ->end()
        ->setParameter('post_title', 'My Post Title')
        ->getQuery();
    $res = $q->execute();

Whilst the two examples above are equivalent it should be noted that we are
being slightly unfair to the PHPCR QOM as we are forced to add the
``phpcr:class`` constraint, which is a PHPCR-ODMism. Despite this, the new API
is clearly less verbose and, I hope, more intelligible.

The API allows chaining together operands:

.. code-block:: php
     
    <?php
    $qb = $documentManager->createQueryBuilder();
    $qb
        ->from()
            ->document('Blog\Post', 'p')
        ->end()
        ->where()
            ->andX()
                ->orX()
                    ->eq()->upperCase()->field('p.username')->end()->literal('DANTLEECH')->end()
                    ->eq()->field('c.initials')->literal('dtl')->end()
                ->end()
                ->lte()->field('p.published_on')->literal('2013-09-14')->end()
            ->end()
        ->end();

The API also allows you to break the query into multiple statements:

.. code-block:: php

    <?php
    $qb->from()->document('Blog\Post', 'p');
    $qb->where()->eq()->field('p.title')->literal('Foobar');
    $qb->orderBy()->asc()->field('p.title');

And to add extra criteria to an existing query builder instance (useful if the query
builder is instantiated and initialized by a vendor library):

.. code-block:: php

    <?php
    class MyExtension
    {
        public function modifyQuery(QueryBuilder $qb)
        {
            $qb->andWhere()->field('f.site_id')->literal(1);
        }
    }

As a bonus, the nature of the API also allows us to easily add multiple
constraints to ``andX`` and ``orX`` operator nodes, something not easily
done with the native PHPCR builder:

.. code-block:: php

    <?php
    $qb->fromDocument('Blog\Post', 'p');
    
    // we can add one or many constraints to an "andX" node...
    $qb->where()->andX()
        ->fieldIsset('p.username')
        ->gt()->field('p.rank')->literal(50)->end()
        ->eq()->fueld('p.title')->literal('This is a title');


The documentation is now online and is made up of both a guide and a reference:

* Guide: http://docs.doctrine-project.org/projects/doctrine-phpcr-odm/en/latest/reference/query-builder.html
* Reference: http://docs.doctrine-project.org/projects/doctrine-phpcr-odm/en/latest/reference/query-builder-reference.html
        </div>

            </article>

    <nav class="mt-4">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/23.html">Newer Posts</a></li><br />
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/25.html">Older Posts</a></li>        </ul>
    </nav>
            </main>

        
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://staging.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?f32c09"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?36322d"></script>

        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            new Main();

            new Search(projectSlug, versionSlug);
        </script>

        
        
        
            </body>
</html>
