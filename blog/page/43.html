<!DOCTYPE html>
<html>
    <head>
        <title>Blog - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?3625e4" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
            </head>
    <body>
                    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu projects-dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/lexer/">Lexer</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="search-results rounded">
                    <div id="hits">
                        <!-- Hits widget will appear here -->
                    </div>

                    <a href="https://www.algolia.com" target="_blank"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
                </div>
            </nav>
        
            <main role="main" class="container-wrapper container">
                        <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/08/10/mongodb-odm-atomic-operator-improvements.html">MongoDB ODM: Atomic Operator Improvements</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-08-10
                            by
                                    jwage
                                    </p>

        <hr />

        <div>
            Recently we've improved the support for use of atomic operators and
how much it takes advantage of them in the Doctrine MongoDB ODM.
Now when updating embedded documents it will use dot annotation to
``$set`` the individual properties instead of sending the entire
document even if only one property changes.

Here is an example, first insert some new data:

.. code-block:: php

    <?php
    $address = new Address();
    $address->setStreet('6512 Mercomatic Ct');
    
    $user = new User();
    $user->setUsername('jwage');
    $user->setAddress($address);
    $user->addPhonenumber(new Phonenumber('6155139185'));
    
    $dm->persist($user);
    $dm->flush();

Now if we make some changes and ``flush()`` again it will perform
an update:

.. code-block:: php

    <?php
    $phonenumbers = $user->getPhonenumbers();
    
    $address->setCity('Nashville');
    $phonenumbers[0]->setPhonenumber('booooo');
    
    $user->addPhonenumber(new Phonenumber('1234'));
    
    $dm->flush();

The above will result in the following queries, first it must run a
``$set`` to modify existing embedded documents:

::

    Array
    (
        [$set] => Array
            (
                [address.city] => Nashville
                [phonenumbers.0.phonenumber] => booooo
            )
    
    )

Then it issues another update to ``$pushAll`` the new
phonenumbers:

::

    Array
    (
        [$pushAll] => Array
            (
                [phonenumbers] => Array
                    (
                        [0] => Array
                            (
                                [phonenumber] => 1234
                            )
    
                    )
    
            )
    
    )
        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/08/07/dc2-experimental-associations-id-fields.html">Experimental Doctrine 2 Feature: Associated Entities as Id Fields</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-08-07
                            by
                                    beberlei
                                    </p>

        <hr />

        <div>
            Doctrine 2 supports composite keys of primitive types from the
beginning, however we realized early that a very common use-case is
a composite key with one or more elements being associated
entities. For example think of a CMS System which allows Article
Translations. A common SQL schema for this case would be:

::

    [sql]
    CREATE TABLE article (id INT PRIMARY KEY, title VARCHAR(255), body LONGTEXT);
    
    CREATE TABLE article_translations (article_id INT, language CHAR(3), title VARCHAR(255), body LONGTEXT, PRIMARY KEY (article_id, language));

This sort of schema cannot be mapped with Doctrine 2 currently, it
would be required to add another column ``id`` on the
article\_translations table and enforce a unique constraint on
article\_id + language.

Under the umbrella of
`DDC-117 <http://www.doctrine-project.org/jira/browse/DDC-117>`_
and some related tickets there were discussions about adding a
feature that would help solve this problem: Allowing to add @Id to
@ManyToOne or @OneToOne mappings. I committed this feature into an
experimental Git branch today and we ask you to test this with as
many crazy scenarios and use-cases as possible.

This feature can potentially be uber-powerful, however we want to
be sure that it works correctly and does not have to many
problematic edge-cases. Therefore we need your feedback.


-  Go to
   `http://github.com/doctrine/doctrine2/commits/DDC-117 <http://github.com/doctrine/doctrine2/commits/DDC-117>`_
   to see the code
-  `Have a look at the functional tests <http://github.com/doctrine/doctrine2/blob/DDC-117/tests/Doctrine/Tests/ORM/Functional/Ticket/DDC117Test.php>`_
   to see the synatx
-  Checkout the Git Repository and switch to the experimental
   branch ``git checkout DDC-117``
-  Do crazy testing against this branch!

Personally I want this feature in core very much, however composite
keys are very tricky. We want to find as many problematic cases
with this feature as possible. That would enable us to evaluate if
this approach will be merged into Doctrine 2.1 or not.

    **NOTE**

    This feature currently only works with Annotations Mapping Driver.
    XML and YAML will follow later.


By the way, the previous example is actually one of the functional
test-cases for this feature:

.. code-block:: php

    <?php
    /**
     * @Entity
     */
    class DDC117Article
    {
        /** @Id @Column(type="integer") @GeneratedValue */
        private $id;
        /** @Column */
        private $title;
    
        /**
         * @OneToMany(targetEntity="DDC117Translation", mappedBy="article")
         */
        private $translations;
    
        public function __construct($title)
        {
            $this->title = $title;
            $this->translations = new \Doctrine\Common\Collections\ArrayCollection();
        }
    }
    
    /**
     * @Entity
     */
    class DDC117Translation
    {
        /**
         * @Id @ManyToOne(targetEntity="DDC117Article")
         */
        private $article;
    
        /**
         * @Id @column(type="string")
         */
        private $language;
    
        /**
         * @column(type="string")
         */
        private $title;
    
        public function __construct($article, $language, $title)
        {
            $this->article = $article;
            $this->language = $language;
            $this->title = $title;
        }
    }
    
    $article = new DDC117Article("foo");
    $em->persist($article);
    $em->flush();
    
    $translation = new DDC117Translation($article, "en", "Bar");
    $em->persist($translation);
    $em->flush();
        </div>

            </article>
    <article>
        <header>
            <h2><a href="https://staging.doctrine-project.org/2010/08/06/doctrine2-orm-beta3.html">Doctrine ORM Beta 3 released</a></h2>
        </header>

        <p class="lead">
            Posted on 2010-08-06
                            by
                                    romanb
                                    </p>

        <hr />

        <div>
            We would like to announce the immediate release of Doctrine ORM
BETA 3:


-  `Installation <http://www.doctrine-project.org/projects/orm/2.0/download/2.0.0BETA3>`_
-  `Changelog <http://www.doctrine-project.org/jira/browse/DDC/fixforversion/10060>`_

We fixed 45 issues, most of them bugs reported by our users. The
ORM package is now in a state where no new features will be added
and we will fully concentrate the efforts on fixing bugs and
bringing the release to a stable state.

Notable changes include:


-  ``EntityManager#merge()`` has been improved considerably and now
   also accepts new entities.
-  Uninitialized Proxies can now be serialized and only throw an
   exception when they are unserialized and accessed without being
   merged into the EntityManager.
-  New method ``EntityManager#getPartialReference()`` that returns
   a partial entity that only contains the entities primary key and
   won't lazy-load (hence "partial").

This release contains three backwards incompatible changes you
should know about when upgrading:

Changed SQL implementation of Postgres and Oracle DateTime types
----------------------------------------------------------------

The DBAL Type "datetime" included the Timezone Offset in both
Postgres and Oracle. As of this version they are now generated
without Timezone (TIMESTAMP WITHOUT TIME ZONE instead of TIMESTAMP
WITH TIME ZONE). See
`this comment to Ticket DBAL-22 <http://www.doctrine-project.org/jira/browse/DBAL-22?focusedCommentId=13396&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#action_13396>`_
for more details as well as migration issues for PostgreSQL and
Oracle.

Both Postgres and Oracle will throw Exceptions during hydration of
Objects with "DateTime" fields unless migration steps are taken!

Removed multi-dot/deep-path expressions in DQL
----------------------------------------------

The support for implicit joins in DQL through the multi-dot/Deep
Path Expressions was dropped. For example:

::

    SELECT u FROM User u WHERE u.group.name = ?1

"u.group.name" is a nested path expression that is an implicit
join. Internally the DQL parser would rewrite these queries to:

::

    SELECT u FROM User u JOIN u.group g WHERE g.name = ?1

This explicit notation will be the only supported notation as of
now. The internal handling of nested path expressions for implicit
joins in the DQL Parser was too complex and error prone in edge
cases and required special treatment for several features we added.
Note that this does not remove any existing functionality, only a
convenience notation that can be expressed otherwise. Hence the
generated SQL of both notations is exactly the same.

Default Allocation Size for Sequences
-------------------------------------

The default allocation size for sequences has been changed from 10
to 1. This step was made to not cause confusion with users and also
because it is partly some kind of premature optimization.

What next
---------

It seems likely that we will not be able to hold the anticipated
release date of September 1st for the final release. Instead
September 1st will likely see the last beta release, BETA 4, after
which we hope to enter the release candiates soon, followed by the
stable release.
        </div>

            </article>

    <nav class="mt-4">
        <ul class="pagination">
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/42.html">Newer Posts</a></li><br />
            <li class="page-item"><a class="page-link" href="https://staging.doctrine-project.org/blog/page/44.html">Older Posts</a></li>        </ul>
    </nav>
            </main>

        
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://staging.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?f32c09"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?36322d"></script>

        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            new Main();

            new Search(projectSlug, versionSlug);
        </script>

        
        
        
            </body>
</html>
