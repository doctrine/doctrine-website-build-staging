<!DOCTYPE html>
<html>
    <head>
        <title>Known Vendor Issues - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://new.doctrine-project.org/css/style.css?9" rel="stylesheet" type="text/css" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://new.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://new.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://new.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://new.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://new.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://new.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://new.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://new.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://new.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://new.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://new.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://new.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://new.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://new.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://new.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://new.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://new.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://new.doctrine-project.org/images/mstile-310x310.png" />

        <link rel="stylesheet" href="https://new.doctrine-project.org/components/highlightjs/styles/railscasts.css?9" />
        <link rel="alternate" type="application/atom+xml" href="https://new.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
        
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>
    </head>
    <body>

        <header>
            <nav class="navbar navbar-expand-md navbar-dark border-bottom">
                <a class="navbar-brand text-hide" href="https://new.doctrine-project.org/"><img src="https://new.doctrine-project.org/images/doctrine-logo.svg" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/">Home</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://new.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://new.doctrine-project.org/projects/lexer/">Lexer</a>
                                                            </div>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://new.doctrine-project.org/search/">Search</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="https://github.com/doctrine/" target="_blank">Development</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>

        <!-- Begin page content -->
        <main role="main" class="container">
                                                                
                                
                                                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="https://new.doctrine-project.org/">Home</a></li>
                            <li class="breadcrumb-item"><a href="https://new.doctrine-project.org/projects/">Projects</a></li>
                            <li class="breadcrumb-item"><a href="https://new.doctrine-project.org/projects/dbal/">DBAL</a></li>
                            <li class="breadcrumb-item"><a href="https://new.doctrine-project.org/projects/doctrine-dbal/en/latest/">Documentation</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Known Vendor Issues</li>
                        </ol>
                    </nav>
                
                                    <ul class="list-inline float-right">
                                                    <li class="list-inline-item mr-0">
                                <a href="/projects/doctrine-dbal/en/latest/reference/known-vendor-issues.html" class="badge badge-primary">master</a>
                            </li>
                                                    <li class="list-inline-item mr-0">
                                <a href="/projects/doctrine-dbal/en/2.6/reference/known-vendor-issues.html" class="badge badge-secondary">2.6</a>
                            </li>
                                                    <li class="list-inline-item mr-0">
                                <a href="/projects/doctrine-dbal/en/2.5/reference/known-vendor-issues.html" class="badge badge-secondary">2.5</a>
                            </li>
                                            </ul>
                
                <!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
</head>
<body>
<h1 class="section-header" id="title.1"><a href="#title.1">Known Vendor Issues<i class="fas fa-link"></i></a></h1>
<p>This section describes known compatability issues with all the
supported database vendors:</p>
<h2 class="section-header" id="title.1.1"><a href="#title.1.1">PostgreSQL<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.1.1"><a href="#title.1.1.1">DateTime, DateTimeTz and Time Types<i class="fas fa-link"></i></a></h3>
<p>Postgres has a variable return format for the datatype TIMESTAMP(n)
and TIME(n) if microseconds are allowed (n &gt; 0). Whenever you save
a value with microseconds = 0, PostgreSQL will return this value in
the format:</p>

<pre><code class="">2010-10-10 10:10:10 (Y-m-d H:i:s)
</code></pre>
<p>However if you save a value with microseconds it will return the
full representation:</p>

<pre><code class="">2010-10-10 10:10:10.123456 (Y-m-d H:i:s.u)
</code></pre>
<p>Using the DateTime, DateTimeTz or Time type (and immutable variants) with microseconds
enabled columns can lead to errors because internally types expect
the exact format 'Y-m-d H:i:s' in combination with
<code>DateTime::createFromFormat()</code>. This method is twice as fast as
passing the date to the constructor of <code>DateTime</code>.</p>
<p>This is why Doctrine always wants to create the time related types
without microseconds:</p>
<ul><li class="dash"> DateTime to <code>TIMESTAMP(0) WITHOUT TIME ZONE</code></li>
<li class="dash"> DateTimeTz to <code>TIMESTAMP(0) WITH TIME ZONE</code></li>
<li class="dash"> Time to <code>TIME(0) WITHOUT TIME ZONE</code></li>
</ul>

<p>If you do not let Doctrine create the date column types and rather
use types with microseconds you have replace the &quot;DateTime&quot;,
&quot;DateTimeTz&quot; and &quot;Time&quot; types (and immutable variants) with a more
liberal DateTime parser that detects the format automatically:</p>

<pre><code class="">use Doctrine\DBAL\Types\Type;

Type::overrideType('datetime', 'Doctrine\DBAL\Types\VarDateTimeType');
Type::overrideType('datetimetz', 'Doctrine\DBAL\Types\VarDateTimeType');
Type::overrideType('time', 'Doctrine\DBAL\Types\VarDateTimeType');

Type::overrideType('datetime_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
Type::overrideType('datetimetz_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
Type::overrideType('time_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
</code></pre>
<h3 class="section-header" id="title.1.1.2"><a href="#title.1.1.2">Timezones and DateTimeTz<i class="fas fa-link"></i></a></h3>
<p>Postgres does not save the actual Timezone Name but UTC-Offsets.
The difference is subtle but can be potentially very nasty. Derick
Rethans explains it very well
<a href="http://derickrethans.nl/storing-date-time-in-database.html">in a blog post of his</a>.</p>
<h2 class="section-header" id="title.1.2"><a href="#title.1.2">MySQL<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.2.1"><a href="#title.1.2.1">DateTimeTz<i class="fas fa-link"></i></a></h3>
<p>MySQL does not support saving timezones or offsets. The DateTimeTz
type therefore behaves like the DateTime type.</p>
<h2 class="section-header" id="title.1.3"><a href="#title.1.3">Sqlite<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.3.1"><a href="#title.1.3.1">Buffered Queries and Isolation<i class="fas fa-link"></i></a></h3>
<p>Be careful if you execute a <code>SELECT</code> query and do not iterate over the
statements results immediately. <code>UPDATE</code> statements executed before iteration
affect only the rows that have not been buffered into PHP memory yet. This
breaks the SERIALIZABLE transaction isolation property that SQLite supposedly
has.</p>
<h3 class="section-header" id="title.1.3.2"><a href="#title.1.3.2">DateTime<i class="fas fa-link"></i></a></h3>
<p>Unlike most database management systems, Sqlite does not convert supplied
datetime strings to an internal storage format before storage. Instead, Sqlite
stores them as verbatim strings (i.e. as they are entered) and expects the user
to use the <code>DATETIME()</code> function when reading data which then converts the
stored values to datetime strings.
Because Doctrine is not using the <code>DATETIME()</code> function, you may end up with
&quot;Could not convert database value ... to Doctrine Type datetime.&quot; exceptions
when trying to convert database values to <code>\DateTime</code> objects using</p>
<pre><code class="php">\Doctrine\DBAL\Types\Type::getType('datetime')-&gt;convertToPhpValue(...)
</code></pre>
<h3 class="section-header" id="title.1.3.3"><a href="#title.1.3.3">DateTimeTz<i class="fas fa-link"></i></a></h3>
<p>Sqlite does not support saving timezones or offsets. The DateTimeTz
type therefore behaves like the DateTime type.</p>
<h3 class="section-header" id="title.1.3.4"><a href="#title.1.3.4">Reverse engineering primary key order<i class="fas fa-link"></i></a></h3>
<p>SQLite versions &lt; 3.7.16 only return that a column is part of the primary key,
but not the order. This is only a problem with tables where the order of the
columns in the table is not the same as the order in the primary key. Tables
created with Doctrine use the order of the columns as defined in the primary
key.</p>
<h2 class="section-header" id="title.1.4"><a href="#title.1.4">IBM DB2<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.4.1"><a href="#title.1.4.1">DateTimeTz<i class="fas fa-link"></i></a></h3>
<p>DB2 does not save the actual Timezone Name but UTC-Offsets. The
difference is subtle but can be potentially very nasty. Derick
Rethans explains it very well
<a href="http://derickrethans.nl/storing-date-time-in-database.html">in a blog post of his</a>.</p>
<h2 class="section-header" id="title.1.5"><a href="#title.1.5">Oracle<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.5.1"><a href="#title.1.5.1">DateTimeTz<i class="fas fa-link"></i></a></h3>
<p>Oracle does not save the actual Timezone Name but UTC-Offsets. The
difference is subtle but can be potentially very nasty. Derick
Rethans explains it very well
<a href="http://derickrethans.nl/storing-date-time-in-database.html">in a blog post of his</a>.</p>
<h3 class="section-header" id="title.1.5.2"><a href="#title.1.5.2">OCI-LOB instances<i class="fas fa-link"></i></a></h3>
<p>Doctrine 2 always requests CLOB columns as strings, so that you as
a developer never get access to the <code>OCI-LOB</code> instance. Since we
are using prepared statements for all write operations inside the
ORM, using strings instead of the <code>OCI-LOB</code> does not cause any
problems.</p>
<h2 class="section-header" id="title.1.6"><a href="#title.1.6">Microsoft SQL Server<i class="fas fa-link"></i></a></h2>
<h3 class="section-header" id="title.1.6.1"><a href="#title.1.6.1">Unique and NULL<i class="fas fa-link"></i></a></h3>
<p>Microsoft SQL Server takes Unique very seriously. There is only
ever one NULL allowed contrary to the standard where you can have
multiple NULLs in a unique column.</p>
<h3 class="section-header" id="title.1.6.2"><a href="#title.1.6.2">DateTime, DateTimeTz and Time Types<i class="fas fa-link"></i></a></h3>
<p>SQL Server has a variable return format for the datatype DATETIME(n)
if microseconds are allowed (n &gt; 0). Whenever you save
a value with microseconds = 0.</p>
<p>If you do not let Doctrine create the date column types and rather
use types with microseconds you have replace the &quot;DateTime&quot;,
&quot;DateTimeTz&quot; and &quot;Time&quot; types (and immutable variants) with a more
liberal DateTime parser that detects the format automatically:</p>

<pre><code class="">use Doctrine\DBAL\Types\Type;

Type::overrideType('datetime', 'Doctrine\DBAL\Types\VarDateTime');
Type::overrideType('datetimetz', 'Doctrine\DBAL\Types\VarDateTime');
Type::overrideType('time', 'Doctrine\DBAL\Types\VarDateTime');

Type::overrideType('datetime_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
Type::overrideType('datetimetz_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
Type::overrideType('time_immutable', 'Doctrine\DBAL\Types\VarDateTimeImmutableType');
</code></pre>
<h3 class="section-header" id="title.1.6.3"><a href="#title.1.6.3">PDO_SQLSRV: VARBINARY/BLOB columns<i class="fas fa-link"></i></a></h3>
<p>The <code>PDO_SQLSRV</code> driver currently has a bug when binding values to
VARBINARY/BLOB columns with <code>bindValue</code> in prepared statements.
This raises an implicit conversion from data type error as it tries
to convert a character type value to a binary type value even if
you explicitly define the value as <code>ParameterType::LARGE_OBJECT</code> type.
Therefore it is highly encouraged to use the native <code>sqlsrv</code>
driver instead which does not have this limitation.</p>
</body>
</html>                    </main>

        <footer class="footer">
            <div class="container">
                <i class="fa fa-copyright"></i> 2018 Doctrine
            </div>
        </footer>

        <script type="text/javascript">
            // When the user scrolls down 20px from the top of the document, show the button
            window.onscroll = function() {scrollFunction()};

            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    document.getElementById('back-to-top').style.display = "block";
                } else {
                    document.getElementById('back-to-top').style.display = "none";
                }
            }

            // When the user clicks on the button, scroll to the top of the document
            function topFunction() {
                document.body.scrollTop = 0; // For Safari
                document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
            }
        </script>

        <button onclick="topFunction()" id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://new.doctrine-project.org/components/highlightjs/highlight.pack.js?9"></script>
        <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        
                    <script type="text/javascript">
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-288343-7', 'auto');
                ga('send', 'pageview');
            </script>
        
        
            </body>
</html>
