<!DOCTYPE html>
<html>
    <head>
        <title>Introduction - Persistence - Doctrine</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Persistence Documentation: Introduction ">

        <meta name="keywords" content="persistence,object,mapper,orm,odm,documentation,introduction">

                    <meta name="robots" content="noindex">
        
                    <link rel="canonical" href="https://staging.doctrine-project.org/projects/doctrine-persistence/en/latest/reference" />
    
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?a4b3e9" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineorm" />
        <meta name="twitter:creator" content="@doctrineorm" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://staging.doctrine-project.org/projects/doctrine-persistence/en/latest/reference" />
        <meta property="og:title" content="Introduction - Persistence - Doctrine" />
        <meta property="og:description" content="Doctrine Persistence Documentation: Introduction " />
        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "Organization",
            "url": "https://staging.doctrine-project.org",
            "logo": "https://staging.doctrine-project.org/images/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "WebSite",
            "url": "https://staging.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://staging.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://staging.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineorm"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "Course",
            "name": "Doctrine Persistence",
            "description": "Introduction",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://staging.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    <nav class="navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/mongodb.html">MongoDB</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/reflection.html">Reflection</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="https://staging.doctrine-project.org/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/contribute/" id="navbarContributeDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Contribute</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/">Contributor Workflow</a>
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/maintainer/">Maintainer Workflow</a>
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/website/">Contribute to Website</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="search-results rounded">
                    <div id="hits">
                        <!-- Hits widget will appear here -->
                    </div>

                    <a href="https://www.algolia.com" target="_blank"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
                </div>
            </nav>
        
            <div class="container-wrapper container-fluid">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        
<div class="toc"><ul><li id="index-html-introduction" class="toc-item"><a href="index.html#introduction">Introduction</a></li><li id="index-html-installation" class="toc-item"><a href="index.html#installation">Installation</a></li><li id="index-html-overview" class="toc-item"><a href="index.html#overview">Overview</a></li><li id="index-html-object-manager" class="toc-item"><a href="index.html#object-manager">Object Manager</a></li><li id="index-html-objectrepository" class="toc-item"><a href="index.html#objectrepository">ObjectRepository</a></li><li id="index-html-mapping" class="toc-item"><a href="index.html#mapping">Mapping</a></li><ul><li id="index-html-classmetadata" class="toc-item"><a href="index.html#classmetadata">ClassMetadata</a></li><li id="index-html-classmetadatafactory" class="toc-item"><a href="index.html#classmetadatafactory">ClassMetadataFactory</a></li></ul><li id="index-html-mapping-driver" class="toc-item"><a href="index.html#mapping-driver">Mapping Driver</a></li><ul><li id="index-html-filedriver" class="toc-item"><a href="index.html#filedriver">FileDriver</a></li><li id="index-html-annotationdriver" class="toc-item"><a href="index.html#annotationdriver">AnnotationDriver</a></li><li id="index-html-phpdriver" class="toc-item"><a href="index.html#phpdriver">PHPDriver</a></li><li id="index-html-staticphpdriver" class="toc-item"><a href="index.html#staticphpdriver">StaticPHPDriver</a></li></ul><li id="index-html-reflection" class="toc-item"><a href="index.html#reflection">Reflection</a></li><li id="index-html-implementations" class="toc-item"><a href="index.html#implementations">Implementations</a></li></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                                                <nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects.html">Projects</a></li>
                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/persistence.html">Persistence</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Documentation</li>
                            </ol>
                        </nav>
                    
                                                        </div>

                
                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine-persistence/en/latest/reference" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        1.0
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                            
                                                <a class="project-version-switcher dropdown-item active" href="/projects/doctrine-persistence/en/latest/reference">
                                                    1.0

                                                                                                            (current)
                                                    
                                                                                                    </a>
                                                                                    
                                                                            </div>
                                </div>

                                <a href="https://github.com/doctrine/persistence/edit/master/docs/en/reference/index.rst" class="btn btn-primary btn-sm">Edit</a>
                            
                            
<p></p>
<a class="section-anchor" id="introduction" name="introduction"></a><h1 class="section-header"><a href="#introduction">Introduction<i class="fas fa-link"></i></a></h1>
<p>The Doctrine Persistence project is a set of shared interfaces and functionality that the different Doctrine
object mappers share. You can use these interfaces and abstract classes to build your own mapper if you don't
want to use the full data mappers provided by Doctrine.</p>
<a class="section-anchor" id="installation" name="installation"></a><h1 class="section-header"><a href="#installation">Installation<i class="fas fa-link"></i></a></h1>
<p>The library can easily be installed with composer.</p>
<pre><code class="sh">$ composer require doctrine/persistence
</code></pre>
<a class="section-anchor" id="overview" name="overview"></a><h1 class="section-header"><a href="#overview">Overview<i class="fas fa-link"></i></a></h1>
<p>The interfaces and functionality in this project evolved from building several different implementations of Doctrine
object mappers. The first implementation was the <a href="https://www.doctrine-project.org/projects/orm.html">ORM</a> then came the <a href="https://www.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a>. A set of common interfaces were
extracted from both projects and released in the <a href="https://www.doctrine-project.org/projects/common.html">Doctrine Common</a> project. Over the years, more common functionality
was extracted and eventually moved to this standalone project.</p>
<p>A Doctrine object mapper looks like this when implemented.</p>
<pre><code class="php">final class User
{
    /** @var string */
    private $username;

    public function __construct(string $username)
    {
        $this-&gt;username = $username;
    }

    // ...
}

$objectManager = new ObjectManager();
$userRepository = $objectManager-&gt;getRepository(User::class);

$newUser = new User('jwage');

$objectManager-&gt;persist($newUser);
$objectManager-&gt;flush();

$user = $objectManager-&gt;find(User::class, 1);

$objectManager-&gt;remove($user);
$objectManager-&gt;flush();

$users = $userRepository-&gt;findAll();
</code></pre>
<p>To learn more about the full interfaces and functionality continue reading!</p>
<a class="section-anchor" id="object-manager" name="object-manager"></a><h1 class="section-header"><a href="#object-manager">Object Manager<i class="fas fa-link"></i></a></h1>
<p>The main public interface that an end user will use is the <code>Doctrine\Common\Persistence\ObjectManager</code> interface.</p>
<pre><code class="php">namespace Doctrine\Common\Persistence;

interface ObjectManager
{
    public function find($className, $id);
    public function persist($object);
    public function remove($object);
    public function merge($object);
    public function clear($objectName = null);
    public function detach($object);
    public function refresh($object);
    public function flush();
    public function getRepository($className);
    public function getClassMetadata($className);
    public function getMetadataFactory();
    public function initializeObject($obj);
    public function contains($object);
}
</code></pre>
<a class="section-anchor" id="objectrepository" name="objectrepository"></a><h1 class="section-header"><a href="#objectrepository">ObjectRepository<i class="fas fa-link"></i></a></h1>
<p>The object repository is used to retrieve instances of your mapped objects from the mapper.</p>
<pre><code class="php">namespace Doctrine\Common\Persistence;

interface ObjectRepository
{
    public function find($id);
    public function findAll();
    public function findBy(array $criteria, ?array $orderBy = null, $limit = null, $offset = null);
    public function findOneBy(array $criteria);
    public function getClassName();
}
</code></pre>
<a class="section-anchor" id="mapping" name="mapping"></a><h1 class="section-header"><a href="#mapping">Mapping<i class="fas fa-link"></i></a></h1>
<p>In order for Doctrine to be able to persist your objects to a data store, you have to map the classes and class
properties so they can be properly stored and retrieved while maintaining a consistent state.</p>
<a class="section-anchor" id="classmetadata" name="classmetadata"></a><h2 class="section-header"><a href="#classmetadata">ClassMetadata<i class="fas fa-link"></i></a></h2>
<pre><code class="php">namespace Doctrine\Common\Persistence\Mapping;

interface ClassMetadata
{
    public function getName();
    public function getIdentifier();
    public function getReflectionClass();
    public function isIdentifier($fieldName);
    public function hasField($fieldName);
    public function hasAssociation($fieldName);
    public function isSingleValuedAssociation($fieldName);
    public function isCollectionValuedAssociation($fieldName);
    public function getFieldNames();
    public function getIdentifierFieldNames();
    public function getAssociationNames();
    public function getTypeOfField($fieldName);
    public function getAssociationTargetClass($assocName);
    public function isAssociationInverseSide($assocName);
    public function getAssociationMappedByTargetField($assocName);
    public function getIdentifierValues($object);
}
</code></pre>
<a class="section-anchor" id="classmetadatafactory" name="classmetadatafactory"></a><h2 class="section-header"><a href="#classmetadatafactory">ClassMetadataFactory<i class="fas fa-link"></i></a></h2>
<p>The <code>Doctrine\Common\Persistence\Mapping\ClassMetadataFactory</code> class can be used to manage the instances for each of
your mapped PHP classes.</p>
<pre><code class="php">namespace Doctrine\Common\Persistence\Mapping;

interface ClassMetadataFactory
{
    public function getAllMetadata();
    public function getMetadataFor($className);
    public function hasMetadataFor($className);
    public function setMetadataFor($className, $class);
    public function isTransient($className);
}
</code></pre>
<a class="section-anchor" id="mapping-driver" name="mapping-driver"></a><h1 class="section-header"><a href="#mapping-driver">Mapping Driver<i class="fas fa-link"></i></a></h1>
<p>In order to load <code>ClassMetadata</code> instances you can use the <code>Doctrine\Common\Persistence\Mapping\Driver\MappingDriver</code>
interface. This is the interface that does the core loading of mapping information from wherever they are stored.
That may be in files, annotations, yaml, xml, etc.</p>
<pre><code class="php">namespace Doctrine\Common\Persistence\Mapping\Driver;

use Doctrine\Common\Persistence\Mapping\ClassMetadata;

interface MappingDriver
{
    public function loadMetadataForClass($className, ClassMetadata $metadata);
    public function getAllClassNames();
    public function isTransient($className);
}
</code></pre>
<p>The Doctrine Persistence project offers a few base implementations that make it easy to implement your own XML,
Annotations or YAML drivers.</p>
<a class="section-anchor" id="filedriver" name="filedriver"></a><h2 class="section-header"><a href="#filedriver">FileDriver<i class="fas fa-link"></i></a></h2>
<p>The file driver operates in a mode where it loads the mapping files of individual classes on demand. This requires
the user to adhere to the convention of 1 mapping file per class and the file names of the mapping files must
correspond to the full class name, including namespace, with the namespace delimiters '\', replaced by dots '.'.</p>
<p>Extend the <code>Doctrine\Common\Persistence\Mapping\Driver\FileDriver</code> class to implement your own file driver.
Here is an example JSON file driver implementation.</p>
<pre><code class="php">use Doctrine\Common\Persistence\Mapping\Driver\FileDriver;

final class JSONFileDriver extends FileDriver
{
    public function loadMetadataForClass($className, ClassMetadata $metadata)
    {
        $mappingFileData = $this-&gt;getElement($className);

        // use the array of mapping information from the file to populate the $metadata instance
    }

    protected function loadMappingFile($file)
    {
        return json_decode($file, true);
    }
}
</code></pre>
<p>Now you can use it like the following.</p>
<pre><code class="php">use Doctrine\Common\Persistence\Mapping\Driver\DefaultFileLocator;

$fileLocator = new DefaultFileLocator('/path/to/mapping/files', 'json');

$jsonFileDriver = new JSONFileDriver($fileLocator);
</code></pre>
<p>Now if you have a class named <code>App\Model\User</code> and you can load the mapping information like this.</p>
<pre><code class="php">use App\Model\User;
use Doctrine\Common\Persistence\Mapping\ClassMetadata;

$classMetadata = new ClassMetadata();

// looks for a file at /path/to/mapping/files/App.Model.User.json
$jsonFileDriver-&gt;loadMetadataForClass(User::class, $classMetadata);
</code></pre>
<a class="section-anchor" id="annotationdriver" name="annotationdriver"></a><h2 class="section-header"><a href="#annotationdriver">AnnotationDriver<i class="fas fa-link"></i></a></h2>
<div class="alert note bg-light-yellow text-dark border"><i class="fas fa-sticky-note text-primary mr-2"></i><p>This driver requires the <code>doctrine/annotations</code> project. You can install it with composer.</p>
<pre><code class="php">composer require doctrine/annotations
</code></pre>
</div>
<p>The AnnotationDriver reads the mapping metadata from docblock annotations.</p>
<pre><code class="php">final class MyAnnotationDriver extends AnnotationDriver
{
    public function loadMetadataForClass($className, ClassMetadata $metadata)
    {
        /** @var ClassMetadata $class */
        $reflClass = $class-&gt;getReflectionClass();

        $classAnnotations = $this-&gt;reader-&gt;getClassAnnotations($reflClass);

        // Use the reader to read annotations from your classes to then populate the $metadata instance.
    }
}
</code></pre>
<p>Now you can use it like the following:</p>
<pre><code class="php">use App\Model\User;
use Doctrine\Common\Annotations\AnnotationReader;
use Doctrine\Common\Persistence\Mapping\ClassMetadata;

$annotationReader = new AnnotationReader();

$annotationDriver = new AnnotationDriver($annotationReader, '/path/to/classes/with/annotations');

$classMetadata = new ClassMetadata();

// looks for a PHP file at /path/to/classes/with/annotations/App/Model/User.php
$annotationDriver-&gt;loadMetadataForClass(User::class, $classMetadata);
</code></pre>
<a class="section-anchor" id="phpdriver" name="phpdriver"></a><h2 class="section-header"><a href="#phpdriver">PHPDriver<i class="fas fa-link"></i></a></h2>
<p>The PHPDriver includes PHP files which just populate <code>ClassMetadata</code> instances with plain PHP code.</p>
<pre><code class="php">use Doctrine\Common\Persistence\Mapping\Driver\PHPDriver;

$phpDriver = new PHPDriver('/path/to/mapping/files');
</code></pre>
<p>Now you can use it like the following:</p>
<pre><code class="php">use App\Model\User;
use Doctrine\Common\Persistence\Mapping\ClassMetadata;

$classMetadata = new ClassMetadata();

// looks for a PHP file at /path/to/mapping/files/App.Model.User.php
$phpDriver-&gt;loadMetadataForClass(User::class, $classMetadata);
</code></pre>
<p>Inside the <code>/path/to/mapping/files/App.Model.User.php</code> file you can write raw PHP code to populate a <code>ClassMetadata</code>
instance. You will have access to a variable named <code>$metadata</code> inside the file that you can use to populate the
mapping metadata.</p>
<pre><code class="php">use App\Model\User;

$metadata-&gt;name = User::class;

// ...
</code></pre>
<a class="section-anchor" id="staticphpdriver" name="staticphpdriver"></a><h2 class="section-header"><a href="#staticphpdriver">StaticPHPDriver<i class="fas fa-link"></i></a></h2>
<p>The StaticPHPDriver calls a static <code>loadMetadata()</code> method on your model classes where you can manually populate the
<code>ClassMetadata</code> instance.</p>
<pre><code class="php">$staticPHPDriver = new StaticPHPDriver('/path/to/classes');

$classMetadata = new ClassMetadata();

// looks for a PHP file at /path/to/classes/App/Model/User.php
$phpDriver-&gt;loadMetadataForClass(User::class, $classMetadata);
</code></pre>
<p>Your class in <code>App\Model\User</code> would look like the following.</p>
<pre><code class="php">namespace App\Model;

final class User
{
    // ...

    public static function loadMetadata(ClassMetadata $metadata)
    {
        // populate the $metadata instance
    }
}
</code></pre>
<a class="section-anchor" id="reflection" name="reflection"></a><h1 class="section-header"><a href="#reflection">Reflection<i class="fas fa-link"></i></a></h1>
<p>Doctrine uses reflection to set and get the data inside your objects. The
<code>Doctrine\Common\Persistence\Mapping\ReflectionService</code> is the primary interface needed for a Doctrine mapper.</p>
<pre><code class="php">namespace Doctrine\Common\Persistence\Mapping;

interface ReflectionService
{
    public function getParentClasses($class);
    public function getClassShortName($class);
    public function getClassNamespace($class);
    public function getClass($class);
    public function getAccessibleProperty($class, $property);
    public function hasPublicMethod($class, $method);
}
</code></pre>
<p>Doctrine provides an implementation of this interface in the class named
<code>Doctrine\Common\Persistence\Mapping\RuntimeReflectionService</code>.</p>
<a class="section-anchor" id="implementations" name="implementations"></a><h1 class="section-header"><a href="#implementations">Implementations<i class="fas fa-link"></i></a></h1>
<p>There are several different implementations of the Doctrine Persistence APIs.</p>
<ul><li class="dash"><a href="https://www.doctrine-project.org/projects/orm.html">ORM</a> - The Doctrine Object Relational Mapper is a data mapper for relational databases.</li>
<li class="dash"><a href="https://www.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a> - The Doctrine MongoDB ODM is a data mapper for MongoDB.</li>
<li class="dash"><a href="https://www.doctrine-project.org/projects/phpcr-odm.html">PHPCR ODM</a> - The Doctrine PHPCR ODM a data mapper built on top of the PHPCR API.</li>
</ul>

<p></p>
                                            </div>
                </div>
            </main>
        </div>
    </div>

                            
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://staging.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://cdn.ravenjs.com/3.24.2/raven.min.js" crossorigin="anonymous"></script>

        <script type="text/javascript">
            Raven.config('https://09ce137590054cfd8f0b7e9324d6ec14@sentry.io/1197701').install()
        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?2a2af0"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?21d569"></script>

        <script type="text/javascript">
            var projectSlug = 'persistence';
            var versionSlug = 'latest';

            new Main();

            new Search(projectSlug, versionSlug);

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                console.log(eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }

            function googleTranslateElementInit() {
                $('#google_translate_element').html('');

                new google.translate.TranslateElement(
                    {pageLanguage: 'en'}, 'google_translate_element'
                );

                $('#google_translate_element select').on('change', function() {
                    var language = $('#google_translate_element select option:selected').text();

                    googleAnalyticsEvent('Translate', 'click', language);
                });
            }
        </script>

        <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async></script>

            <script src="https://staging.doctrine-project.org/js/sidebar.js?01f3db"></script>

    <script type="text/javascript">
        new Sidebar();
    </script>

        
        
            </body>
</html>
