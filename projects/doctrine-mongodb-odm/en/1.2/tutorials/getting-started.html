<!DOCTYPE html>
<html>
    <head>
        <title>Getting Started - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

                    <meta name="robots" content="noindex, follow">
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?f6e2f2" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/components/highlightjs/styles/railscasts.css?b4f8ae" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        
            </head>
    <body>
                    <nav class="navbar navbar-expand-md navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?335f0f" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects/" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/annotations/">Annotations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/cache/">Cache</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/collections/">Collections</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/common/">Common</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/couchdb-odm/">CouchDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/dbal/">DBAL</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/inflector/">Inflector</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/lexer/">Lexer</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/migrations/">Migrations</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb/">MongoDB</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orientdb-odm/">OrientDB ODM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/orm/">ORM</a>
                                                                    <a class="dropdown-item" href="https://staging.doctrine-project.org/projects/phpcr-odm/">PHPCR ODM</a>
                                                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/about/">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/contribute/">Contribute</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>

                <div class="rounded" id="hits">
                    <!-- Hits widget will appear here -->
                </div>
            </nav>
        
            <div class="container-wrapper container-fluid">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        
<div class="toc"><ul><li id="getting-started-html-title-1" class="toc-item"><a href="getting-started.html#title.1">Getting Started</a></li><ul><li id="getting-started-html-title-1-1" class="toc-item"><a href="getting-started.html#title.1.1">Example Model: Simple Blog</a></li><li id="getting-started-html-title-1-2" class="toc-item"><a href="getting-started.html#title.1.2">A first prototype</a></li><li id="getting-started-html-title-1-3" class="toc-item"><a href="getting-started.html#title.1.3">Persistent Models</a></li><li id="getting-started-html-title-1-4" class="toc-item"><a href="getting-started.html#title.1.4">Usage</a></li></ul></ul></div>
                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                                                
                                        
                                                                <nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/">Projects</a></li>
                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/mongodb-odm/">MongoDB ODM</a></li>
                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/doctrine-mongodb-odm/en/1.2/">Documentation</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Getting Started</li>
                            </ol>
                        </nav>
                                    </div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            <ul class="list-inline">
                                                                            <li class="list-inline-item mr-0">
                                            <a href="/projects/doctrine-mongodb-odm/en/latest/tutorials/getting-started.html" class="project-version-switcher badge badge-secondary">master</a>
                                        </li>
                                                                            <li class="list-inline-item mr-0">
                                            <a href="/projects/doctrine-mongodb-odm/en/1.2/tutorials/getting-started.html" class="project-version-switcher badge badge-warning">1.2</a>
                                        </li>
                                                                            <li class="list-inline-item mr-0">
                                            <a href="/projects/doctrine-mongodb-odm/en/1.1/tutorials/getting-started.html" class="project-version-switcher badge badge-secondary">1.1</a>
                                        </li>
                                    
                                    
                                    <li class="list-inline-item ml-2"><a href="https://github.com/doctrine/mongodb-odm/edit/1.2.x/docs/en/tutorials/getting-started.rst" class="badge badge-primary">Edit</a></li>

                                </ul>
                            
                            
<a class="section-anchor" id="title.1" name="title.1"></a><h1 class="section-header"><a href="#title.1">Getting Started<i class="fas fa-link"></i></a></h1>
<p>Doctrine is a project that aims to handle the persistence of your
domain model in a non-interfering way. Non-relational or no-sql
databases like MongoDB give you flexibility of building data store
around your object model and not vise versa. You can read more on the
initial configuration and setup in <a href="../reference/introduction.html">Introduction to MongoDB Object
Document Mapper</a>. This section will give you a basic
overview of what could be accomplished using Doctrine MongoDB ODM.</p>
<a class="section-anchor" id="title.1.1" name="title.1.1"></a><h2 class="section-header"><a href="#title.1.1">Example Model: Simple Blog<i class="fas fa-link"></i></a></h2>
<p>To create the simplest example, let’s assume the following in a simple blog web application:</p>
<ul><li class="dash"> Blog has a user.</li>
<li class="dash"> Blog user can make blog posts</li>
</ul>

<a class="section-anchor" id="title.1.2" name="title.1.2"></a><h2 class="section-header"><a href="#title.1.2">A first prototype<i class="fas fa-link"></i></a></h2>
<p>For the above mentioned example, something as simple as this could be modeled with plain PHP classes.
First define the <code>User</code> document:</p>
<pre><code class="php">&lt;?php

namespace Documents;

class User
{
    private $name;
    private $email;
    private $posts = array();

    // ...
}
</code></pre>
<p>Now define the <code>BlogPost</code> document:</p>
<pre><code class="php">&lt;?php

namespace Documents;

class BlogPost
{
    private $title;
    private $body;
    private $createdAt;

    // ...
}
</code></pre>
<a class="section-anchor" id="title.1.3" name="title.1.3"></a><h2 class="section-header"><a href="#title.1.3">Persistent Models<i class="fas fa-link"></i></a></h2>
<p>To make the above classes persistent, all we need to do is provide Doctrine with some mapping
information so that it knows how to consume the objects and persist them to the database.</p>
<p>You can provide your mapping information in Annotations, XML, or YAML:</p>
<div class="configuration-block"><pre><code class="php">&lt;?php
use Doctrine\ODM\MongoDB\Mapping\Annotations as ODM;

/** @ODM\Document */
class User
{
    /** @ODM\Id */
    private $id;

    /** @ODM\Field(type=&quot;string&quot;) */
    private $name;

    /** @ODM\Field(type=&quot;string&quot;) */
    private $email;

    /** @ODM\ReferenceMany(targetDocument=&quot;BlogPost&quot;, cascade=&quot;all&quot;) */
    private $posts = array();

    // ...
}

/** @ODM\Document */
class BlogPost
{
    /** @ODM\Id */
    private $id;

    /** @ODM\Field(type=&quot;string&quot;) */
    private $title;

    /** @ODM\Field(type=&quot;string&quot;) */
    private $body;

    /** @ODM\Field(type=&quot;date&quot;) */
    private $createdAt;

    // ...
}
</code></pre>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;doctrine-mongo-mapping xmlns=&quot;http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping&quot;
                xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                xsi:schemaLocation=&quot;http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping
                http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping.xsd&quot;&gt;
  &lt;document name=&quot;Documents\User&quot;&gt;
        &lt;field fieldName=&quot;id&quot; id=&quot;true&quot; /&gt;
        &lt;field fieldName=&quot;name&quot; type=&quot;string&quot; /&gt;
        &lt;field fieldName=&quot;email&quot; type=&quot;string&quot; /&gt;
        &lt;reference-many fieldName=&quot;posts&quot; targetDocument=&quot;Documents\BlogPost&quot;&gt;
            &lt;cascade&gt;
                &lt;all/&gt;
            &lt;/cascade&gt;
        &lt;/reference-many&gt;
  &lt;/document&gt;
&lt;/doctrine-mongo-mapping&gt;

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;doctrine-mongo-mapping xmlns=&quot;http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping&quot;
                xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                xsi:schemaLocation=&quot;http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping
                http://doctrine-project.org/schemas/odm/doctrine-mongo-mapping.xsd&quot;&gt;
  &lt;document name=&quot;Documents\BlogPost&quot;&gt;
        &lt;field fieldName=&quot;id&quot; id=&quot;true&quot; /&gt;
        &lt;field fieldName=&quot;title&quot; type=&quot;string&quot; /&gt;
        &lt;field fieldName=&quot;body&quot; type=&quot;string&quot; /&gt;
        &lt;field fieldName=&quot;createdAt&quot; type=&quot;date&quot; /&gt;
  &lt;/document&gt;
&lt;/doctrine-mongo-mapping&gt;
</code></pre>
<pre><code class="yaml">Documents\User:
  fields:
    id:
      type: id
      id: true
    name:
      type: string
    email:
      type: string
  referenceMany:
    posts:
      targetDocument: Documents\BlogPost
      cascade: all

Documents\BlogPost:
  fields:
    id:
      type: id
      id: true
    title:
      type: string
    body:
      type: string
    createdAt:
      type: date
</code></pre>
</div>
<p>That’s it, we have our models, and we can save and retrieve them. Now
all we need to do is to properly instantiate the <code>DocumentManager</code>
instance. Read more about setting up the Doctrine MongoDB ODM in the
<a href="../reference/introduction.html">Introduction to MongoDB Object Document Mapper</a>:</p>
<pre><code class="php">&lt;?php

use Doctrine\MongoDB\Connection;
use Doctrine\ODM\MongoDB\Configuration;
use Doctrine\ODM\MongoDB\DocumentManager;
use Doctrine\ODM\MongoDB\Mapping\Driver\AnnotationDriver;

AnnotationDriver::registerAnnotationClasses();

$config = new Configuration();
$config-&gt;setProxyDir('/path/to/generate/proxies');
$config-&gt;setProxyNamespace('Proxies');
$config-&gt;setHydratorDir('/path/to/generate/hydrators');
$config-&gt;setHydratorNamespace('Hydrators');
$config-&gt;setMetadataDriverImpl(AnnotationDriver::create('/path/to/document/classes'));

$dm = DocumentManager::create(new Connection(), $config);
</code></pre>
<a class="section-anchor" id="title.1.4" name="title.1.4"></a><h2 class="section-header"><a href="#title.1.4">Usage<i class="fas fa-link"></i></a></h2>
<p>Here is how you would use your models now:</p>
<pre><code class="php">&lt;?php

// ...

// create user
$user = new User();
$user-&gt;setName('Bulat S.');
$user-&gt;setEmail('email@example.com');

// tell Doctrine 2 to save $user on the next flush()
$dm-&gt;persist($user);

// create blog post
$post = new BlogPost();
$post-&gt;setTitle('My First Blog Post');
$post-&gt;setBody('MongoDB + Doctrine 2 ODM = awesomeness!');
$post-&gt;setCreatedAt(new DateTime());

$user-&gt;addPost($post);

// store everything to MongoDB
$dm-&gt;flush();
</code></pre>
<div class="alert note bg-light-yellow text-dark border"><i class="fas fa-sticky-note text-primary mr-2"></i><p>Note that you do not need to explicitly call persist on the <code>$post</code> because the operation
will cascade on to the reference automatically.</p>
</div>
<p>Now if you did everything correctly, you should have those two objects
stored in MongoDB in correct collections and databases. You can use the
<a href="http://github.com/jwage/php-mongodb-admin">php-mongodb-admin project, hosted on github</a> to look at your
<code>BlogPost</code> collection, where you will see only one document:</p>

<pre><code class="">Array
(
    [_id] =&gt; 4bec5869fdc212081d000000
    [title] =&gt; My First Blog Post
    [body] =&gt; MongoDB + Doctrine 2 ODM = awesomeness!
    [createdAt] =&gt; MongoDate Object
        (
            [sec] =&gt; 1273723200
            [usec] =&gt; 0
        )
)
</code></pre>
<p>And the <code>User</code> collection would consist of the following:</p>

<pre><code class="">Array
(
    [_id] =&gt; 4bec5869fdc212081d010000
    [name] =&gt; Bulat S.
    [email] =&gt; email@example.com
    [posts] =&gt; Array
        (
            [0] =&gt; Array
                (
                    [$ref] =&gt; blog_posts
                    [$id] =&gt; 4bec5869fdc212081d000000
                    [$db] =&gt; test_database
                )
        )
)
</code></pre>
<p>You can retrieve the user later by its identifier:</p>
<pre><code class="php">&lt;?php

// ...

$userId = '....';
$user = $dm-&gt;find('User', $userId);
</code></pre>
<p>Or you can find the user by name even:</p>
<pre><code class="php">&lt;?php

$user = $dm-&gt;getRepository('User')-&gt;findOneByName('Bulat S.');
</code></pre>
<p>If you want to iterate over the posts the user references it is as easy as the following:</p>
<pre><code class="php">&lt;?php

$posts = $dm-&gt;getPosts();
foreach ($posts as $post) {
}
</code></pre>
<p>You will notice that working with objects is nothing magical and you only have access to the properties,
getters and setters that you have defined yourself so the semantics are very clear. You can continue
reading about the MongoDB in the <a href="../reference/introduction.html">Introduction to MongoDB Object Document Mapper</a>.</p>
                                            </div>
                </div>
            </main>
        </div>
    </div>

                            
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://staging.doctrine-project.org/components/highlightjs/highlight.pack.js?3970aa"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?f32c09"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?a06250"></script>

        <script type="text/javascript">
            var projectSlug = 'mongodb-odm';
            var versionSlug = '1.2';

            new Main();

            new Search(projectSlug, versionSlug);
        </script>

            <script src="https://staging.doctrine-project.org/js/sidebar.js?cd221a"></script>

    <script type="text/javascript">
        new Sidebar();
    </script>

        
        
            </body>
</html>
