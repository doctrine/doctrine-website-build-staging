<!DOCTYPE html>
<html>
    <head>
        <title>        Caching - Doctrine Doctrine1 ORM (Doctrine1)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Doctrine1 ORM Documentation: Caching ">

        <meta name="keywords" content="                    php,doctrine1,orm,database,documentation,caching
    ">

                    <meta name="robots" content="noindex">
        
        
                    <link rel="canonical" href="https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/caching.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://staging.doctrine-project.org/frontend/css/index.css?30e146"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/caching.html" />
        <meta property="og:title" content="        Caching - Doctrine Doctrine1 ORM (Doctrine1)
    " />
        <meta property="og:description" content="Doctrine Doctrine1 ORM Documentation: Caching " />
        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://staging.doctrine-project.org",
            "logo": "https://staging.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://staging.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://staging.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://staging.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Doctrine1 ORM",
            "description": "Caching",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://staging.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://staging.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/doctrine1/edit/master/docs/en/manual/caching.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        

            <div class="toc">
    <ul class="menu-level">
    </ul>
</div>
    

                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://staging.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "Doctrine1",
            "item": "https://staging.doctrine-project.org/projects/doctrine1.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://staging.doctrine-project.org/projects/doctrine1/en/latest/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Caching",
            "item": "https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/caching.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/doctrine1.html">Doctrine1</a></li>
                                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/doctrine1/en/latest/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Caching</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>This project is no longer maintained and has been archived.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine1/en/latest/manual/caching.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        master
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine1/en/latest/manual/caching.html">
                                                        master

                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                                                                                    </div>
                                </div>
                            
                            

            <div class="section" id="caching">
            <h1 class="section-header ">
    <a href="#caching">
        Caching
        <i class="fas fa-link"></i>
    </a>
</h1>
            <div class="section" id="introduction">
            <h2 class="section-header ">
    <a href="#introduction">
        Introduction
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>Doctrine_Cache offers an intuitive and easy-to-use query caching
solution. It provides the following things:</p>

            

<ul>
    <li class="dash">Multiple cache backends to choose from (including Memcached, APC and
Sqlite)</li>
    <li class="dash">Advanced options for fine-tuning. Doctrine_Cache has many
options for fine-tuning performance.</li>
</ul>

            
    <p>All the cache drivers are instantiated like the following:</p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>options = array();
<span class="noselect">$ </span>cacheDriver = new Doctrine_Cache_Memcache( $options );</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>Each driver has its own possible values for the
<code>$options</code> array.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
    </div>
            <div class="section" id="drivers">
            <h2 class="section-header ">
    <a href="#drivers">
        Drivers
        <i class="fas fa-link"></i>
    </a>
</h2>
            <div class="section" id="memcache">
            <h3 class="section-header ">
    <a href="#memcache">
        Memcache
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Memcache driver stores cache records into a memcached server. Memcached
is a high-performance, distributed memory object caching system. In
order to use this backend, you need a memcached daemon and the memcache
PECL extension.</p>

            
    <p>You can instantiate the Memcache cache driver with the following code:</p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>servers = array(
    'host'       => 'localhost',
    'port'       => 11211,
    'persistent' => true
);

<span class="noselect">$ </span>cacheDriver = new Doctrine_Cache_Memcache(
    array(
        'servers' => $servers,
        'compression' => false
    )
);</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>Memcache allows multiple servers.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            
    <p>Available options for Memcache driver:</p>

            <table>
                <thead>
            <tr>
                            <th>Option</th>
                            <th>Data Type</th>
                            <th>Default Value</th>
                            <th>Description</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>servers</code></td>
            <td><code>array</code></td>
            <td><code>array(array(&#039;host&#039; =&gt; &#039;localhost&#039;,&#039;port&#039; =&gt; 11211, &#039;persistent&#039; =&gt; true))</code></td>
            <td>An array of memcached servers ; each memcached
server is described by an associative array :
<code>&#039;host&#039; =&gt; (string)</code> : the name of the memcached
server, <code>&#039;port&#039; =&gt; (int)</code> : the port of the
memcached server, <code>&#039;persistent&#039; =&gt; (bool)</code> : use
or not persistent connections to this memcached server</td>
    </tr>
    <tr>
            <td><code>compression</code></td>
            <td><code>boolean</code></td>
            <td><code>false</code></td>
            <td><code>true</code> if you want to use on-the-fly compression</td>
    </tr>
</tbody>
</table>
    </div>
            <div class="section" id="apc">
            <h3 class="section-header ">
    <a href="#apc">
        APC
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>The Alternative PHP Cache (APC) is a free and open opcode cache for PHP.
It was conceived to provide a free, open, and robust framework for
caching and optimizing PHP intermediate code. The APC cache driver of
Doctrine stores cache records in shared memory.</p>

            
    <p>You can instantiate the APC cache driver with the following code:</p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>cacheDriver = new Doctrine_Cache_Apc();</code></pre></div>
    </div>
            <div class="section" id="db">
            <h3 class="section-header ">
    <a href="#db">
        Db
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Db caching backend stores cache records into given database. Usually
some fast flat-file based database is used (such as sqlite).</p>

            
    <p>You can instantiate the database cache driver with the following code:</p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>cacheConn   = Doctrine_Manager::connection( new PDO( 'sqlite::memory:' ) );
<span class="noselect">$ </span>cacheDriver = new Doctrine_Cache_Db( array( 'connection' => $cacheConn ) );</code></pre></div>
    </div>
    </div>
            <div class="section" id="query-cache-result-cache">
            <h2 class="section-header ">
    <a href="#query-cache-result-cache">
        Query Cache &amp; Result Cache
        <i class="fas fa-link"></i>
    </a>
</h2>
            <div class="section" id="introduction">
            <h3 class="section-header ">
    <a href="#introduction">
        Introduction
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Doctrine provides means for caching the results of the DQL parsing
process, as well as the end results of DQL queries (the data). These two
caching mechanisms can greatly increase performance. Consider the
standard workflow of DQL query execution:</p>

            <blockquote>

<ul>
    <li class="dash">Init new DQL query</li>
    <li class="dash">Parse DQL query</li>
    <li class="dash">Build database specific SQL query</li>
    <li class="dash">Execute the SQL query</li>
    <li class="dash">Build the result set</li>
    <li class="dash">Return the result set</li>
</ul>
</blockquote>
            
    <p>Now these phases can be very time consuming, especially phase 4 which
sends the query to your database server. When Doctrine query cache is
being used only the following phases occur:</p>

            <blockquote>

<ul>
    <li class="dash">Init new DQL query</li>
    <li class="dash">Execute the SQL query (grabbed from the cache)</li>
    <li class="dash">Build the result set</li>
    <li class="dash">Return the result set</li>
</ul>
</blockquote>
            
    <p>If a DQL query has a valid cache entry the cached SQL query is used,
otherwise the phases 2-3 are executed normally and the result of these
steps is then stored in the cache. The query cache has no disadvantages,
since you always get a fresh query result.</p>

                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>You should always use query cache in a production
environment. That said, you can easily use it during development,
too. Whenever you change a DQL query and execute it the first time
Doctrine sees that it has been modified and will therefore create a
new cache entry, so you don&#039;t even need to invalidate the cache.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            
    <p>It&#039;s worth noting that the effectiveness of the query cache greatly
relies on the usage of prepared statements (which are used by Doctrine
by default anyway). You should not directly embed dynamic query parts
and always use placeholders instead.</p>

            
    <p>When using a result cache things get even better. Then your query
process looks as follows (assuming a valid cache entry is found):</p>

            <blockquote>

<ul>
    <li class="dash">Init new DQL query</li>
    <li class="dash">Return the result set</li>
</ul>
</blockquote>
            
    <p>As you can see, the result cache implies the query cache shown
previously. You should always consider using a result cache if the data
returned by the query does not need to be up-to-date at any time.</p>

    </div>
            <div class="section" id="query-cache">
            <h3 class="section-header ">
    <a href="#query-cache">
        Query Cache
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="section" id="using-the-query-cache">
            <h4 class="section-header ">
    <a href="#using-the-query-cache">
        Using the Query Cache
        <i class="fas fa-link"></i>
    </a>
</h4>
            
    <p>You can set a connection or manager level query cache driver by using
the <code>Doctrine_Core::ATTR_QUERY_CACHE</code> attribute. Setting a
connection level cache driver means that all queries executed with this
connection use the specified cache driver whereas setting a manager
level cache driver means that all connections (unless overridden at
connection level) will use the given cache driver.</p>

            
    <p><strong>Setting a manager level query cache driver:</strong></p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>manager->setAttribute( Doctrine_Core::ATTR_QUERY_CACHE, $cacheDriver );</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>The value of <code>$cacheDriver</code> above could be any of the
drivers we instantiated in the previous section of this chapter.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            
    <p><strong>Setting a connection level cache driver:</strong></p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>conn->setAttribute( Doctrine_Core::ATTR_QUERY_CACHE, $cacheDriver );</code></pre></div>
    </div>
            <div class="section" id="fine-tuning">
            <h4 class="section-header ">
    <a href="#fine-tuning">
        Fine Tuning
        <i class="fas fa-link"></i>
    </a>
</h4>
            
    <p>In the previous chapter we used global caching attributes. These
attributes can be overriden at the query level. You can override the
cache driver by calling <code>useQueryCache()</code> and pass it an instance of a
valid Doctrine cache driver. This rarely makes sense for the query cache
but is possible:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
    ->useQueryCache(new Doctrine_Cache_Apc() );</code></pre></div>
    </div>
    </div>
            <div class="section" id="result-cache">
            <h3 class="section-header ">
    <a href="#result-cache">
        Result Cache
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="section" id="using-the-result-cache">
            <h4 class="section-header ">
    <a href="#using-the-result-cache">
        Using the Result Cache
        <i class="fas fa-link"></i>
    </a>
</h4>
            
    <p>You can set a connection or manager level result cache driver by using
<code>Doctrine_Core::ATTR_RESULT_CACHE</code>. Setting a connection level
cache driver means that all queries executed with this connection use
the specified cache driver whereas setting a manager level cache driver
means that all connections (unless overridden at connection level) will
use the given cache driver.</p>

            
    <p><strong>Setting a manager level cache driver:</strong></p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>manager->setAttribute( Doctrine_Core::ATTR_RESULT_CACHE, $cacheDriver );</code></pre></div>
            
    <p><strong>Setting a connection level cache driver:</strong></p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>conn->setAttribute( Doctrine_Core::ATTR_RESULT_CACHE, $cacheDriver );</code></pre></div>
            
    <p>Usually the cache entries are valid for only some time. You can set
global value for how long the cache entries should be considered valid
by using <code>Doctrine_Core::ATTR_RESULT_CACHE_LIFESPAN</code>.</p>

            
    <p><strong>Set the lifespan as one hour (60 seconds * 60 minutes = 1 hour = 3600
secs):</strong></p>

            <div class="console"><pre><code class="console">// bootstrap.php

// ...
<span class="noselect">$ </span>manager->setAttribute( Doctrine_Core::ATTR_RESULT_CACHE_LIFESPAN, 3600 );</code></pre></div>
            
    <p>Now as we have set a cache driver for use we can make a DQL query use it
by calling the <code>useResultCache()</code> method:</p>

            
    <p><strong>Fetch blog post titles and the number of comments:</strong></p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
    ->select( 'b.title, COUNT(c.id) count' )
    ->from( 'BlogPost b' )
    ->leftJoin( 'b.Comments c' )
    ->limit( 10 )
    ->useResultCache( true );

<span class="noselect">$ </span>blogPosts = $q->execute();</code></pre></div>
    </div>
            <div class="section" id="fine-tuning">
            <h4 class="section-header ">
    <a href="#fine-tuning">
        Fine Tuning
        <i class="fas fa-link"></i>
    </a>
</h4>
            
    <p>In the previous chapter we used global caching attributes. These
attributes can be overriden at the query level. You can override the
cache driver by calling <code>useCache()</code> and pass it an instance of a
valid Doctrine cache driver.</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
    ->useResultCache(new Doctrine_Cache_Apc() );</code></pre></div>
            
    <p>Also you can override the lifespan attribute by calling
<code>setResultCacheLifeSpan()</code>:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>q = Doctrine_Query::create()
    ->setResultCacheLifeSpan( 60 * 30 );</code></pre></div>
    </div>
    </div>
    </div>
            <div class="section" id="conclusion">
            <h2 class="section-header ">
    <a href="#conclusion">
        Conclusion
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>Using the caching feature of Doctrine is highly recommended in both
development and production environments. There are no adverse affects to
using it and it will only help the performance of your application.</p>

            
    <p>The caching feature is the second to last feature we will discuss in
this book before wrapping things up by discussing things like
the <a href="technology.html">Technology</a>, <a href="coding-standards.html">Coding Standards</a>
and <a href="unit-testing.html">Unit Testing</a>. Lets move on to discuss
the last feature of Doctrine, <a href="migrations.html">Migrations</a>.</p>

    </div>
    </div>
        

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://staging.doctrine-project.org/frontend/js/bundle.js?ff3b61"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'doctrine1';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search Doctrine1 master'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                console.log(eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
        
            </body>
</html>
