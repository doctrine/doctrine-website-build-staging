<!DOCTYPE html>
<html>
    <head>
        <title>        Database Abstraction Layer - Doctrine Doctrine1 ORM (Doctrine1)
    </title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="Doctrine Doctrine1 ORM Documentation: Database Abstraction Layer ">

        <meta name="keywords" content="                    php,doctrine1,orm,database,documentation,database,abstraction,layer
    ">

                    <meta name="robots" content="noindex">
        
        
                    <link rel="canonical" href="https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/database-abstraction-layer.html" />
    
        <link
            rel="stylesheet"
            type="text/css"
            href="https://staging.doctrine-project.org/frontend/css/index.css?c900c9"
                        crossorigin="anonymous"
        />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineproject" />
        <meta name="twitter:creator" content="@doctrineproject" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/database-abstraction-layer.html" />
        <meta property="og:title" content="        Database Abstraction Layer - Doctrine Doctrine1 ORM (Doctrine1)
    " />
        <meta property="og:description" content="Doctrine Doctrine1 ORM Documentation: Database Abstraction Layer " />
        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "url": "https://staging.doctrine-project.org",
            "logo": "https://staging.doctrine-project.org/logos/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "url": "https://staging.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://staging.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://staging.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineproject"
            ]
        }
        </script>

                    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Course",
            "name": "Doctrine Doctrine1 ORM",
            "description": "Database Abstraction Layer",
            "provider": {
                "@type": "Organization",
                "name": "Doctrine",
                "sameAs": "https://staging.doctrine-project.org"
            }
        }
        </script>
    
        
            </head>
    <body>
                    
            <nav class="doctrine-navbar navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="/index.html"><img src="https://staging.doctrine-project.org/logos/doctrine-logo.svg?1a5b7c" />Doctrine</a>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown active">
                            <a class="nav-link dropdown-toggle" href="/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item" href="/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item" href="/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item" href="/projects/common.html">Common</a>
                                                                    <a class="dropdown-item" href="/projects/data-fixtures.html">Data fixtures</a>
                                                                    <a class="dropdown-item" href="/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item" href="/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item" href="/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item" href="/projects/instantiator.html">Instantiator</a>
                                                                    <a class="dropdown-item" href="/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item" href="/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item" href="/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item" href="/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item" href="/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item" href="/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item" href="/projects/rst-parser.html">RST Parser</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/contribute/index.html" id="navbarDevelopmentDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Development</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="/community/index.html">Community</a>
                                <a class="dropdown-item" href="/contribute/index.html">Contributor Workflow</a>
                                <a class="dropdown-item" href="/contribute/maintainer/index.html">Maintainer Workflow</a>
                                <a class="dropdown-item" href="/contribute/website/index.html">Contribute to Website</a>
                                <a class="dropdown-item" href="/policies.html">Policies</a>
                                <a class="dropdown-item" href="https://github.com/doctrine" target="_blank" rel="noopener noreferrer">GitHub</a>
                                <a class="dropdown-item" href="/styleguide.html">Styleguide</a>
                            </div>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/sponsorship.html">Sponsorship</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/partners.html">Partners</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/index.html">Blog</a>
                        </li>
                    </ul>

                    <div class="layout-edit-button d-inline-block mr-2">
                                                    <a href="https://github.com/doctrine/doctrine1/edit/master/docs/en/manual/database-abstraction-layer.rst" class="btn btn-light" target="_blank" rel="noopener noreferrer">Edit</a>
                                            </div>
                </div>
                <div class="nav-outbound">
                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank" rel="noopener noreferrer"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <div class="container-wrapper container">
        <div class="row row-offcanvas row-offcanvas-right">
                            <nav class="col-md-3 d-sm-block bg-light sidebar sidebar-offcanvas" id="sidebar">
                    <div class="sidebar-sticky">
                        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7D553W&placement=wwwdoctrine-projectorg" id="_carbonads_js"></script>

                        

            <div class="toc">
    <ul class="menu-level">
    </ul>
</div>
    

                    </div>
                </nav>
            
            <main role="main" class="col-md-9 ml-sm-auto col-lg-9 pt-3 px-4">
                <div class="row">
                                        
                                                                <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
                {
            "@type": "ListItem",
            "position": 1,
            "name": "Projects",
            "item": "https://staging.doctrine-project.org/projects.html"
        },                {
            "@type": "ListItem",
            "position": 2,
            "name": "Doctrine1",
            "item": "https://staging.doctrine-project.org/projects/doctrine1.html"
        },                {
            "@type": "ListItem",
            "position": 3,
            "name": "Documentation",
            "item": "https://staging.doctrine-project.org/projects/doctrine1/en/latest/index.html"
        },                {
            "@type": "ListItem",
            "position": 4,
            "name": "Database Abstraction Layer",
            "item": "https://staging.doctrine-project.org/projects/doctrine1/en/latest/manual/database-abstraction-layer.html"
        }            ]
}
</script>

<nav class="breadcrumbs d-none d-sm-block d-md-block d-lg-block d-xl-block" aria-label="breadcrumb">
    <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects.html">Projects</a></li>
                                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/doctrine1.html">Doctrine1</a></li>
                                                <li class="breadcrumb-item"><a href="https://staging.doctrine-project.org/projects/doctrine1/en/latest/index.html">Documentation</a></li>
                                                <li class="breadcrumb-item active" aria-current="page">Database Abstraction Layer</li>
                        </ol>
</nav>
                                    </div>

                    
    <div class="alert caution bg-light-yellow text-dark border">
    <table width="100%">
        <tr>
            <td width="10" class="align-top">
                <i class="fas fa-exclamation-circle text-warning mr-2"></i>
            </td>
            <td><p>This project is no longer maintained and has been archived.</p></td>
        </tr>
    </table>
</div>

                <div class="row">
                    <div class="col-12">
                                                    <button type="button" class="btn btn-primary btn-sm float-right toc-toggle" data-toggle="offcanvas" id="toc-toggle">Table of Contents</button>

                                                            
                                <div class="dropdown show d-inline-block">
                                    <a class="project-version-switcher btn btn-secondary btn-sm dropdown-toggle" href="/projects/doctrine1/en/latest/manual/database-abstraction-layer.html" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        master
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                                                                    <h6 class="dropdown-header">Maintained</h6>

                                                                                                                                                
                                                    <a class="project-version-switcher dropdown-item active" href="/projects/doctrine1/en/latest/manual/database-abstraction-layer.html">
                                                        master

                                                        
                                                                                                            </a>
                                                                                                                                    
                                                                                    <h6 class="dropdown-header">Unmaintained</h6>

                                                                                                                                                                                                                    </div>
                                </div>
                            
                            

            <div class="section" id="database-abstraction-layer">
            <h1 class="section-header ">
    <a href="#database-abstraction-layer">
        Database Abstraction Layer
        <i class="fas fa-link"></i>
    </a>
</h1>
            
    <p>The Doctrine Database Abstraction Layer is the underlying framework that
the ORM uses to communicate with the database and send the appropriate
SQL depending on which database type you are using. It also has the
ability to query the database for information like what table a database
has or what fields a table has. This is how Doctrine is able to generate
your models from existing databases so easily.</p>

            
    <p>This layer can be used independently of the ORM. This might be of use
for example if you have an existing application that uses PDO directly
and you want to port it to use the Doctrine Connections and DBAL. At a
later phase you could begin to use the ORM for new things and rewrite
old pieces to use the ORM.</p>

            
    <p>The DBAL is composed of a few different modules. In this chapter we will
discuss the different modules and what their jobs are.</p>

            <div class="section" id="export">
            <a id="database-abstraction-layer-export"></a>
            <h2 class="section-header ">
    <a href="#export">
        Export
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>The Export module provides methods for managing database structure. The
methods can be grouped based on their responsibility: create, edit
(alter or update), list or delete (drop) database elements. The
following document lists the available methods, providing examples of
their use.</p>

            <div class="section" id="introduction">
            <h3 class="section-header ">
    <a href="#introduction">
        Introduction
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Every schema altering method in the Export module has an equivalent
which returns the SQL that is used for the altering operation. For
example <code>createTable()</code> executes the query / queries returned by
<code>createTableSql()</code>.</p>

            
    <p>In this chapter the following tables will be created, altered and
finally dropped, in a database named <code>events_db</code>:</p>

            
    <p><strong>events</strong></p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Primary</th>
                            <th>Auto Increment</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>id</code></td>
            <td><code>integer</code></td>
            <td><code>true</code></td>
            <td><code>true</code></td>
    </tr>
    <tr>
            <td><code>name</code></td>
            <td><code>string(255)</code></td>
            <td><code>false</code></td>
            <td><code>false</code></td>
    </tr>
    <tr>
            <td><code>datetime</code></td>
            <td><code>timestamp</code></td>
            <td><code>false</code></td>
            <td><code>false</code></td>
    </tr>
</tbody>
</table>
            
    <p><strong>people</strong></p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Primary</th>
                            <th>Auto Increment</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>id</code></td>
            <td><code>integer</code></td>
            <td><code>true</code></td>
            <td><code>true</code></td>
    </tr>
    <tr>
            <td><code>name</code></td>
            <td><code>string(255)</code></td>
            <td><code>false</code></td>
            <td><code>false</code></td>
    </tr>
</tbody>
</table>
            
    <p><strong>event_participants</strong></p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Primary</th>
                            <th>Auto Increment</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>event_id</code></td>
            <td><code>integer</code></td>
            <td><code>true</code></td>
            <td><code>false</code></td>
    </tr>
    <tr>
            <td><code>person_id</code></td>
            <td><code>string(255)</code></td>
            <td><code>true</code></td>
            <td><code>false</code></td>
    </tr>
</tbody>
</table>
    </div>
            <div class="section" id="creating-databases">
            <h3 class="section-header ">
    <a href="#creating-databases">
        Creating Databases
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>It is simple to create new databases with Doctrine. It is only a matter
of calling the <code>createDatabase()</code> function with an argument that is
the name of the database to create.</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>conn->export->createDatabase('events_db');</code></pre></div>
            
    <p>Now lets change the connection in our <code>bootstrap.php</code> file to connect
to the new <code>events_db</code>:</p>

            <div class="console"><pre><code class="console">// bootstrap.php

/**
 * Bootstrap Doctrine.php, register autoloader and specify
 * configuration attributes
 */

 // ...
 $conn = Doctrine_Manager::connection('mysql://root:@localhost/events_db', 'doctrine');

 // ...</code></pre></div>
    </div>
            <div class="section" id="creating-tables">
            <h3 class="section-header ">
    <a href="#creating-tables">
        Creating Tables
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Now that the database is created and we&#039;ve re-configured our connection,
we can proceed with adding some tables. The method <code>createTable()</code>
takes three parameters: the table name, an array of field definition and
some extra options (optional and RDBMS-specific).</p>

            
    <p>Now lets create the <code>events</code> table:</p>

            <div class="console"><pre><code class="console">// test.php

//
<span class="noselect">$ </span>definition = array(
    'id' => array(
        'type' => 'integer',
        'primary' => true,
        'autoincrement' => true
    ),
    'name' => array(
        'type' => 'string',
        'length' => 255
    ),
    'datetime' => array(
        'type' => 'timestamp'
    )
);

<span class="noselect">$ </span>conn->export->createTable('events', $definition);</code></pre></div>
            
    <p>The keys of the definition array are the names of the fields in the
table. The values are arrays containing the required key <code>type</code> as
well as other keys, depending on the value of <code>type</code>. The values for
the <code>type</code> key are the same as the possible Doctrine datatypes.
Depending on the datatype, the other options may vary.</p>

            <table>
                <thead>
            <tr>
                            <th>Datatype</th>
                            <th>length</th>
                            <th>default</th>
                            <th>not null</th>
                            <th>unsigned</th>
                            <th>autoincrement</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>string</code></td>
            <td>x</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>boolean</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>integer</code></td>
            <td>x</td>
            <td>x</td>
            <td>x</td>
            <td>x</td>
            <td>x</td>
    </tr>
    <tr>
            <td><code>decimal</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>float</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>timestamp</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>time</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>date</code></td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>clob</code></td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
    <tr>
            <td><code>blob</code></td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>x</td>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
    </tr>
</tbody>
</table>
            
    <p>And now we can go ahead and create the <code>people</code> table:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>definition = array(
    'id' => array(
        'type' => 'integer',
        'primary' => true,
        'autoincrement' => true
    ),
    'name' => array(
        'type' => 'string',
        'length' => 255
    )
);

<span class="noselect">$ </span>conn->export->createTable('people', $definition);</code></pre></div>
            
    <p>You can also specify an array of options as the third argument to the
<code>createTable()</code> method:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>options = array(
    'comment'       => 'Repository of people',
    'character_set' => 'utf8',
    'collate'       => 'utf8_unicode_ci',
    'type'          => 'innodb',
);

// ...

<span class="noselect">$ </span>conn->export->createTable('people', $definition, $options);</code></pre></div>
    </div>
            <div class="section" id="creating-foreign-keys">
            <h3 class="section-header ">
    <a href="#creating-foreign-keys">
        Creating Foreign Keys
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Creating the <code>event_participants</code> table with a foreign key:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>options = array(
    'foreignKeys' => array(
        'events_id_fk' => array(
            'local' => 'event_id',
            'foreign' => 'id',
            'foreignTable' => 'events',
            'onDelete' => 'CASCADE',
        )
    ),
    'primary' => array( 'event_id', 'person_id'),
);

<span class="noselect">$ </span>definition = array(
    'event_id' => array(
        'type' => 'integer',
        'primary' => true
    ),
    'person_id' => array(
        'type' => 'integer',
        'primary' => true
    ),
);

<span class="noselect">$ </span>conn->export->createTable('event_participants', $definition, $options);</code></pre></div>
            <div class="alert -admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas   mr-2"></i></td>
            <td>
                                                
    <p>In the above example notice how we omit a foreign key for
the <code>person_id</code>. In that example we omit it so we can show you
how to add an individual foreign key to a table in the next example.
Normally it would be best to have both foreign keys defined on the
in the <code>foreignKeys</code>.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            
    <p>Now lets add the missing foreign key in the <code>event_participants</code>
table the on <code>person_id</code> column:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>definition = array('local' => 'person_id',
                    'foreign' => 'id',
                    'foreignTable' => 'people',
                    'onDelete' => 'CASCADE');

<span class="noselect">$ </span>conn->export->createForeignKey('event_participants', $definition);</code></pre></div>
    </div>
            <div class="section" id="altering-table">
            <h3 class="section-header ">
    <a href="#altering-table">
        Altering table
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Doctrine_Export drivers provide an easy database portable way of
altering existing database tables.</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>alter = array(
    'add' => array(
        'new_column' => array(
            'type' => 'string',
            'length' => 255
        ),
        'new_column2' => array(
            'type' => 'string',
            'length' => 255
        )
    )
);

echo $conn->export->alterTableSql('events', $alter);</code></pre></div>
            
    <p>The above call to <code>alterTableSql()</code> would output the following SQL
query:</p>

            <div class="console"><pre><code class="console">ALTER TABLE events ADD new_column VARCHAR(255),
ADD new_column2 VARCHAR(255)</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>If you only want execute generated sql and not return it,
use the <code>alterTable()</code> method.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>conn->export->alterTable('events', $alter);</code></pre></div>
            
    <p>The <code>alterTable()</code> method requires two parameters and has an optional
third:</p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Description</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><strong>$name</strong></td>
            <td><code>string</code></td>
            <td>Name of the table that is intended to be changed.</td>
    </tr>
    <tr>
            <td><strong>$changes</strong></td>
            <td><code>array</code></td>
            <td>Associative array that contains the details of each type of change that is intended to be performed.</td>
    </tr>
</tbody>
</table>
            
    <p>An optional third parameter (default: <code>false</code>):</p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Description</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><strong>$check</strong></td>
            <td><code>boolean</code></td>
            <td>Check if the DBMS can actually perform the operation before executing.</td>
    </tr>
</tbody>
</table>
            
    <p>The types of changes that are currently supported are defined as
follows:</p>

            <table>
                <thead>
            <tr>
                            <th>Change</th>
                            <th>Description</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><strong>name</strong></td>
            <td>New name for the table.</td>
    </tr>
    <tr>
            <td><strong>add</strong></td>
            <td>Associative array with the names of fields to be added as indexes of the array. The value of each entry of
the array should be set to another associative array with the properties of
the fields to be added. The properties of the fields should be the same as defined by the Doctrine parser.</td>
    </tr>
    <tr>
            <td><strong>remove</strong></td>
            <td>Associative array with the names of fields to be removed as indexes of the array. Currently the values assigned to each entry are ignored. An
empty array should be used for future compatibility.</td>
    </tr>
    <tr>
            <td><strong>rename</strong></td>
            <td>Associative array with the names of fields to be renamed as indexes of the array. The value of each entry of the array should be set to
another associative array with the entry named name with the new
field name and the entry named Declaration that is expected to contain the portion of the field declaration already in DBMS specific SQL code
as it is used in the <code>CREATE TABLE</code> statement.</td>
    </tr>
    <tr>
            <td><strong>change</strong></td>
            <td>Associative array with the names of the fields to be changed as indexes of the array. Keep in mind that if it is intended to change
either the name of a field and any other properties, the change array
entries should have the new names of the fields as array indexes.</td>
    </tr>
</tbody>
</table>
            
    <p>The value of each entry of the array should be set to another
associative array with the properties of the fields to that are meant to
be changed as array entries. These entries should be assigned to the new
values of the respective properties. The properties of the fields should
be the same as defined by the Doctrine parser.</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>alter = array('name' => 'event',
               'add' => array(
                   'quota' => array(
                       'type' => 'integer',
                       'unsigned' => 1
                   )
               ),
               'remove' => array(
                   'new_column2' => array()
               ),
               'change' => array(
                   'name' => array(
                       'length' => '20',
                       'definition' => array(
                           'type' => 'string',
                           'length' => 20
                       )
                   )
               ),
               'rename' => array(
                   'new_column' => array(
                       'name' => 'gender',
                       'definition' => array(
                           'type' => 'string',
                           'length' => 1,
                           'default' => 'M'
                       )
                   )
               )
           );

<span class="noselect">$ </span>conn->export->alterTable('events', $alter);</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>Notice how we renamed the table to <code>event</code>, lets rename
it back to <code>events</code>. We only renamed it to demonstrate the
functionality and we will need the table to be named <code>events</code> for
the next examples.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>alter = array(
    'name' => 'events'
);

<span class="noselect">$ </span>conn->export->alterTable('event', $alter);</code></pre></div>
    </div>
            <div class="section" id="creating-indexes">
            <h3 class="section-header ">
    <a href="#creating-indexes">
        Creating Indexes
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>To create an index, the method <code>createIndex()</code> is used, which has
similar signature as <code>createConstraint()</code>, so it takes table name,
index name and a definition array. The definition array has one key
named <code>fields</code> with a value which is another associative array
containing fields that will be a part of the index. The fields are
defined as arrays with possible keys: sorting, with values ascending and
descending length, integer value</p>

            
    <p>Not all RDBMS will support index sorting or length, in these cases the
drivers will ignore them. In the test events database, we can assume
that our application will show events occuring in a specific timeframe,
so the selects will use the datetime field in <code>WHERE</code> conditions. It
will help if there is an index on this field.</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>definition = array(
    'fields' => array(
        'datetime' => array()
    )
);

<span class="noselect">$ </span>conn->export->createIndex('events', 'datetime', $definition);</code></pre></div>
    </div>
            <div class="section" id="deleting-database-elements">
            <h3 class="section-header ">
    <a href="#deleting-database-elements">
        Deleting database elements
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>For every <code>create*()</code> method as shown above, there is a corresponding
<code>drop*()</code> method to delete a database, a table, field, index or
constraint. The <code>drop*()</code> methods do not check if the item to be
deleted exists, so it&#039;s developer&#039;s responsibility to check for
exceptions using a try catch block:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
try {
    $conn->export->dropSequence('nonexisting');
} catch(Doctrine_Exception $e) {

}</code></pre></div>
            
    <p>You can easily drop a constraint with the following code:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>conn->export->dropConstraint('events', 'PRIMARY', true);</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>The third parameter gives a hint that this is a primary key
constraint.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            <div class="console"><pre><code class="console">// test.php

// ... $conn->export->dropConstraint('event_participants', 'event_id');</code></pre></div>
            
    <p>You can easily drop an index with the following code:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>conn->export->dropIndex('events', 'event_timestamp');</code></pre></div>
            <div class="alert -admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas   mr-2"></i></td>
            <td>
                                                
    <p>It is recommended to not actually execute the next two
examples. In the next section we will need the <code>events_db</code> to be
intact for our examples to work.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            
    <p>Drop a table from the database with the following code:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>conn->export->dropTable('events');</code></pre></div>
            
    <p>We can drop the database with the following code:</p>

            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>conn->export->dropDatabase('events_db');</code></pre></div>
    </div>
    </div>
            <div class="section" id="import">
            <a id="database-abstraction-layer-import"></a>
            <h2 class="section-header ">
    <a href="#import">
        Import
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>The import module allows you to inspect a the contents of a database
connection and learn about the databases and schemas in each database.</p>

            <div class="section" id="introduction">
            <h3 class="section-header ">
    <a href="#introduction">
        Introduction
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>To see what&#039;s in the database, you can use the <code>list*()</code> family of
functions in the Import module.</p>

            <table>
                <thead>
            <tr>
                            <th>Name</th>
                            <th>Description</th>
                    </tr>
        </thead>
    <tbody>
    <tr>
            <td><code>listDatabases()</code></td>
            <td>List the databases</td>
    </tr>
    <tr>
            <td><code>listFunctions()</code></td>
            <td>List the available functions.</td>
    </tr>
    <tr>
            <td><code>listSequences($dbName)</code></td>
            <td>List the available sequences. Takes optional database name as a parameter. If not supplied,
the currently selected database is assumed.</td>
    </tr>
    <tr>
            <td><code>listTableConstraints($tableName)</code></td>
            <td>Lists the available tables. takes a table name</td>
    </tr>
    <tr>
            <td><code>listTableColumns($tableName)</code></td>
            <td>List the columns available in a table.</td>
    </tr>
    <tr>
            <td><code>listTableIndexes($tableName)</code></td>
            <td>List the indexes defined in a table.</td>
    </tr>
    <tr>
            <td><code>listTables($dbName)</code></td>
            <td>List the tables in a database.</td>
    </tr>
    <tr>
            <td><code>listTableTriggers($tableName)</code></td>
            <td>List the triggers in a table.</td>
    </tr>
    <tr>
            <td><code>listTableViews($tableName)</code></td>
            <td>List the views available in a table.</td>
    </tr>
    <tr>
            <td><code>listUsers()</code></td>
            <td>List the users for the database.</td>
    </tr>
    <tr>
            <td><code>listViews($dbName)</code></td>
            <td>List the views available for a database.</td>
    </tr>
</tbody>
</table>
            
    <p>Below you will find examples on how to use the above listed functions:</p>

    </div>
            <div class="section" id="listing-databases">
            <h3 class="section-header ">
    <a href="#listing-databases">
        Listing Databases
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>databases = $conn->import->listDatabases();
print_r($databases);</code></pre></div>
    </div>
            <div class="section" id="listing-sequences">
            <h3 class="section-header ">
    <a href="#listing-sequences">
        Listing Sequences
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ... $sequences = $conn->import->listSequences('events_db');
print_r($sequences);</code></pre></div>
    </div>
            <div class="section" id="listing-constraints">
            <h3 class="section-header ">
    <a href="#listing-constraints">
        Listing Constraints
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>constraints = $conn->import->listTableConstraints('event_participants');
print_r($constraints);</code></pre></div>
    </div>
            <div class="section" id="listing-table-columns">
            <h3 class="section-header ">
    <a href="#listing-table-columns">
        Listing Table Columns
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ... $columns = $conn->import->listTableColumns('events');
print_r($columns);</code></pre></div>
    </div>
            <div class="section" id="listing-table-indexes">
            <h3 class="section-header ">
    <a href="#listing-table-indexes">
        Listing Table Indexes
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ... $indexes = $conn->import->listTableIndexes('events');
print_r($indexes);</code></pre></div>
    </div>
            <div class="section" id="listing-tables">
            <h3 class="section-header ">
    <a href="#listing-tables">
        Listing Tables
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console"><span class="noselect">$ </span>tables = $conn->import->listTables();
print_r($tables);</code></pre></div>
    </div>
            <div class="section" id="listing-views">
            <h3 class="section-header ">
    <a href="#listing-views">
        Listing Views
        <i class="fas fa-link"></i>
    </a>
</h3>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>Currently there is no method to create views, so let&#039;s do it manually.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            <div class="console"><pre><code class="console"><span class="noselect">$ </span>sql = "CREATE VIEW names_only AS SELECT name FROM people";
<span class="noselect">$ </span>conn->exec($sql);

<span class="noselect">$ </span>sql = "CREATE VIEW last_ten_events AS SELECT * FROM events ORDER BY id DESC LIMIT 0,10";
<span class="noselect">$ </span>conn->exec($sql);</code></pre></div>
            
    <p>Now we can list the views we just created:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>views = $conn->import->listViews();
print_r($views);</code></pre></div>
    </div>
    </div>
            <div class="section" id="datadict">
            <a id="database-abstraction-layer-datadict"></a>
            <h2 class="section-header ">
    <a href="#datadict">
        DataDict
        <i class="fas fa-link"></i>
    </a>
</h2>
            <div class="section" id="introduction">
            <h3 class="section-header ">
    <a href="#introduction">
        Introduction
        <i class="fas fa-link"></i>
    </a>
</h3>
            
    <p>Doctrine uses the <code>DataDict</code> module internally to convert native RDBMS
types to Doctrine types and the reverse. <code>DataDict</code> module uses two
methods for the conversions:</p>

            

<ul>
    <li class="dash"><code>getPortableDeclaration()</code>, which is used for converting native
RDBMS type declaration to portable Doctrine declaration</li>
    <li class="dash"><code>getNativeDeclaration()</code>, which is used for converting portable
Doctrine declaration to driver specific type declaration</li>
</ul>

    </div>
            <div class="section" id="getting-portable-declaration">
            <h3 class="section-header ">
    <a href="#getting-portable-declaration">
        Getting portable declaration
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>declaration = $conn->dataDict->getPortableDeclaration('VARCHAR(255)');

print_r($declaration);</code></pre></div>
            
    <p>The above example would output the following:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>php test.php
Array
(
    [type] => Array
        (
            [0] => string
        )
    [length] => 255
    [unsigned] =>
    [fixed] =>
)</code></pre></div>
    </div>
            <div class="section" id="getting-native-declaration">
            <h3 class="section-header ">
    <a href="#getting-native-declaration">
        Getting Native Declaration
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>portableDeclaration = array(
    'type' => 'string',
    'length' => 20,
    'fixed' => true
);

<span class="noselect">$ </span>nativeDeclaration = $conn->dataDict->getNativeDeclaration($portableDeclaration);

echo $nativeDeclaration;</code></pre></div>
            
    <p>The above example would output the following:</p>

            <div class="console"><pre><code class="console"><span class="noselect">$ </span>php test.php
CHAR(20)</code></pre></div>
    </div>
    </div>
            <div class="section" id="drivers">
            <h2 class="section-header ">
    <a href="#drivers">
        Drivers
        <i class="fas fa-link"></i>
    </a>
</h2>
            <div class="section" id="mysql">
            <h3 class="section-header ">
    <a href="#mysql">
        Mysql
        <i class="fas fa-link"></i>
    </a>
</h3>
            <div class="section" id="setting-table-type">
            <h4 class="section-header ">
    <a href="#setting-table-type">
        Setting table type
        <i class="fas fa-link"></i>
    </a>
</h4>
            <div class="console"><pre><code class="console">// test.php

// ...
<span class="noselect">$ </span>fields = array(
    'id' => array(
        'type' => 'integer',
        'autoincrement' => true
    ),
    'name' => array(
        'type' => 'string',
        'fixed' => true,
        'length' => 8
    )
);</code></pre></div>
                        <div class="alert note-admonition bg-light-yellow text-dark border ">
    <table width="100%">
        <tbody>
        <tr>
            <td width="10" class="align-top"><i class="fas fa-sticky-note text-primary mr-2"></i></td>
            <td>
                                                
    <p>The following option is mysql specific and skipped by other
drivers.</p>

            </td>
        </tr>
        </tbody>
    </table>
</div>
            <div class="console"><pre><code class="console"><span class="noselect">$ </span>options = array('type' => 'INNODB');

<span class="noselect">$ </span>sql = $conn->export->createTableSql('test_table', $fields);
echo $sql[0];</code></pre></div>
            
    <p>The above will output the following SQL query:</p>

            <div class="console"><pre><code class="console">CREATE TABLE test_table (id INT AUTO_INCREMENT,
name CHAR(8)) ENGINE = INNODB</code></pre></div>
    </div>
    </div>
    </div>
            <div class="section" id="conclusion">
            <h2 class="section-header ">
    <a href="#conclusion">
        Conclusion
        <i class="fas fa-link"></i>
    </a>
</h2>
            
    <p>This chapter is indeed a nice one. The Doctrine DBAL is a great tool all
by itself. It is probably one of the most fully featured and easy to use
PHP database abstraction layers available today.</p>

            
    <p>Now we are ready to move on and learn about how to use <a href="transactions.html">Transactions</a>.</p>

    </div>
    </div>
        

                                                </div>
                </div>
            </main>
        </div>
    </div>

        <button id="back-to-top" title="Go to top">Top</button>

                
        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script
            src="https://staging.doctrine-project.org/frontend/js/bundle.js?ff3b61"
                        crossorigin="anonymous">
        </script>

                
        <script type="text/javascript">
            var projectSlug = 'doctrine1';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search Doctrine1 master'
            };

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                console.log(eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }
        </script>

        
        
            </body>
</html>
