<!DOCTYPE html>
<html>
    <head>
        <title>はじめに - Doctrine - PHP Database Tools</title>

        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <meta name="description" content="The Doctrine Project is the home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
">

        <meta name="keywords" content="php,mysql,orm,dbal,database,mongodb,odm,annotations,migrations,cache,couchdb">

                    <meta name="robots" content="noindex">
        
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" integrity="sha384-3AB7yXWz4OeoZcPbieVW64vVXEwADiYyAEhwilzWsLw+9FgqpyjjStpPnpBO8o8S" crossorigin="anonymous">

        <link href="https://staging.doctrine-project.org/css/style.css?c8b404" rel="stylesheet" type="text/css" />

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">

        <link rel="stylesheet" href="https://staging.doctrine-project.org/css/railscasts.css?62eb49" />

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://staging.doctrine-project.org/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://staging.doctrine-project.org/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://staging.doctrine-project.org/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://staging.doctrine-project.org/images/apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://staging.doctrine-project.org/images/apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://staging.doctrine-project.org/images/apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://staging.doctrine-project.org/images/apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://staging.doctrine-project.org/images/apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="https://staging.doctrine-project.org/images/favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Doctrine"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="https://staging.doctrine-project.org/images/mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="https://staging.doctrine-project.org/images/mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="https://staging.doctrine-project.org/images/mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="https://staging.doctrine-project.org/images/mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="https://staging.doctrine-project.org/images/mstile-310x310.png" />

        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@doctrineorm" />
        <meta name="twitter:creator" content="@doctrineorm" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://staging.doctrine-project.org/projects/doctrine1/ja/latest/manual/yaml-schema-files.html" />
        <meta property="og:title" content="はじめに - Doctrine - PHP Database Tools" />
        <meta property="og:description" content="The Doctrine Project is the home to several PHP libraries primarily focused on database storage and object mapping. The core projects are the Object Relational Mapper (ORM) and the Database Abstraction Layer (DBAL) it is built upon.
" />
        <meta property="og:image" content="https://staging.doctrine-project.org/images/og.png" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="1200" />

        <link rel="alternate" type="application/atom+xml" href="https://staging.doctrine-project.org/atom.xml" title="Doctrine activity feed" />

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "Organization",
            "url": "https://staging.doctrine-project.org",
            "logo": "https://staging.doctrine-project.org/images/doctrine-logo.svg"
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "WebSite",
            "url": "https://staging.doctrine-project.org",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://staging.doctrine-project.org?q={search_term_string}",
                "query-input": "required name=search_term_string"
            }
        }
        </script>

        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "Organization",
            "name": "Doctrine",
            "url": "https://staging.doctrine-project.org",
            "sameAs": [
                "https://twitter.com/doctrineorm"
            ]
        }
        </script>

        
        
            </head>
    <body>
                    <nav class="navbar navbar-expand-lg navbar-dark sticky-top bg-dark flex-md-nowrap">
                <a class="navbar-brand text-hide" href="https://staging.doctrine-project.org/"><img src="https://staging.doctrine-project.org/images/doctrine-logo.svg?6c0dab" />Doctrine</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/projects.html" id="navbarProjectsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Projects
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarProjectsDropdown">
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/annotations.html">Annotations</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/cache.html">Cache</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/coding-standard.html">Coding Standard</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/collections.html">Collections</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/common.html">Common</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/dbal.html">DBAL</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/event-manager.html">Event Manager</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/inflector.html">Inflector</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/lexer.html">Lexer</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/migrations.html">Migrations</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/mongodb.html">MongoDB</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/mongodb-odm.html">MongoDB ODM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/orm.html">ORM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/persistence.html">Persistence</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/phpcr-odm.html">PHPCR ODM</a>
                                                                    <a class="dropdown-item notranslate" href="https://staging.doctrine-project.org/projects/reflection.html">Reflection</a>
                                                                <a class="dropdown-item bg-secondary text-white font-weight-bold" href="https://staging.doctrine-project.org/projects.html">View All</a>
                            </div>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="https://staging.doctrine-project.org/contribute/" id="navbarContributeDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Contribute</a>

                            <div class="dropdown-menu" aria-labelledby="navbarContributeDropdown">
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/">Contributor Workflow</a>
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/maintainer/">Maintainer Workflow</a>
                                <a class="dropdown-item" href="https://staging.doctrine-project.org/contribute/website/">Contribute to Website</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/community/">Community</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/blog/">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://staging.doctrine-project.org/team/">Team</a>
                        </li>
                    </ul>

                    <div class="google-translate-dropdown dropdown show d-inline-block mr-2">
                        <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="translateDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Translate
                        </a>

                        <div class="dropdown-menu" aria-labelledby="translateDropdown">
                            <div class="dropdown-item" id="google_translate_element">Loading...</div>
                        </div>
                    </div>

                    <div id="search-box">
                        <!-- SearchBox widget will appear here -->
                    </div>
                </div>
            </nav>

            <div class="search-results rounded">
                <div id="hits">
                    <!-- Hits widget will appear here -->
                </div>

                <a href="https://www.algolia.com" target="_blank"><img src="https://staging.doctrine-project.org/images/search-by-algolia.png" class="float-right" style="width: 150px;" /></a>
            </div>
        
            <main role="main" class="container-wrapper container">
                    
<p></p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">はじめに<i class="fas fa-link"></i></a></h1>
<p>スキーマファイルの目的はPHPコードの編集よりもYAMLファイルでモデルの定義を直接管理できるようにすることです。すべてのモデルの定義/クラスを生成するためにYAMLスキーマファイルは解析され使われます。これによってDoctrineモデルの定義がはるかにポータブルなものになります。</p>
<p>スキーマファイルはPHPコードで書く通常のすべての内容をサポートします。接続バインディング用のコンポーネント、リレーション、属性、テンプレート/ビヘイビア、インデックスなどがあります。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">省略構文<i class="fas fa-link"></i></a></h1>
<p>Doctrineは省略記法でスキーマを指定する機能を提供します。多くのスキーマパラメータはデフォルトの値を持ち、これによって構文をできるのでDoctrineはデフォルトを利用できます。すべての省略記法を利用したスキーマの例は下記の通りです。</p>
<blockquote><p><strong>NOTE</strong>
<code>detect_relations</code>オプションによってカラムの名前からリレーションの推測が行われます。下記の例ではDoctrine
は<code>User</code>が1つの<code>Contact</code>を持つことを知っておりモデルの間のリレーションを自動的に定義します。</p>
<p>ect\_relations: true</p>
</blockquote>
<p>User: columns: username: string password: string contact\_id: integer</p>
<p>Contact: columns: first\_name: string last\_name: string phone: string
email: string address: string</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">冗長な構文<i class="fas fa-link"></i></a></h1>
<p>上記のスキーマを100%冗長にしたものは次の通りです:</p>
<blockquote><p>User: columns: username: type: string(255) password: type: string(255)</p>
</blockquote>
<p>contact\_id: type: integer relations: Contact: class: Contact local:
contact\_id foreign: id foreignAlias: User foreignType: one type: one</p>
<p>Contact: columns: first\_name: type: string(255) last\_name: type:
string(255) phone: type: string(255) email: type: string(255) address:
type: string(255) relations: User: class: User local: id foreign:
contact\_id foreignAlias: Contact foreignType: one type: one</p>
<p>上記の例では<code>detect_relations</code>オプションを定義せず、代わりにローカル/外部キー、型、とそれぞれの側のリレーションのエイリアスの設定を通して完全にコントロールできるように手動でリレーションを定義します。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">リレーション<i class="fas fa-link"></i></a></h1>
<p>リレーションを指定するとき外部キーが存在している方のリレーションを指定することだけが必要です。スキーマファイルが解析されるとき、Doctrineはリレーションを反映し反対側を自動的にビルドします。もう一方のリレーションを指定する場合、自動生成は行われません。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">リレーションを検出する<i class="fas fa-link"></i></a></h2>
<p>前に見たようにDoctrineは<code>detect\_relations</code>オプションを指定する機能を提供します。この機能はカラムの名前に基づいてリレーションを自動的に構築します。<code>contact_id</code>を持つ<code>User</code>モデルと<code>Contact</code>という名前を持つクラスが存在する場合、2つの間のリレーションが自動的に作成されます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">リレーションをカスタマイズする<i class="fas fa-link"></i></a></h2>
<p>Doctrineは外部キーが存在している側のリレーションを指定することのみを要求します。リレーションの反対側は反映されもう一方側に基づいてビルドされます。スキーマ構文はリレーションのエイリアスと反対側の型をカスタマイズする機能を提供します。すべての関連するリレーションを一箇所で維持できるのでこれはよいニュースです。下記の内容はエイリアスと反対側のリレーションの型をカスタマイズする方法です。これは<code>User</code>が1つの<code>Contact</code>を持ち<code>Contact</code>は1つの<code>User</code>を<code>UserModel</code>として持つというリレーションを示しています。通常は自動生成された<code>User</code>は1つの<code>Contact</code>を持ち<code>Contact</code>は複数の<code>User</code>を持ちます。<code>foreignType</code>と<code>foreignAlias</code>オプションによって反対側のリレーションをカスタマイズできます。</p>
<blockquote><p>User: columns: id: type: integer(4) primary: true autoincrement: true</p>
</blockquote>
<p>contact\_id: type: integer(4) username: type: string(255) password:
type: string(255) relations: Contact: foreignType: one foreignAlias:
UserModel</p>
<p>Contact: columns: id: type: integer(4) primary: true autoincrement: true
name: type: string(255)</p>
<p>次のようにthe
detect\_relationsオプションを持つ2つのモデルの間のリレーションを見つけて作成できます。</p>
<blockquote><p>detect\_relations: true</p>
</blockquote>
<p>User: columns: id: type: integer(4) primary: true autoincrement: true
avatar\_id: type: integer(4) username: type: string(255) password: type:
string(255)</p>
<p>Avatar: columns: id: type: integer(4) primary: true autoincrement: true
name: type: string(255) image\_file: type: string(255)</p>
<p>結果のリレーションは<code>User</code>は1つの<code>Avatar</code>を持ち<code>Avatar</code>は複数の<code>User</code>を持ちます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">一対一<i class="fas fa-link"></i></a></h2>
<blockquote><p>User: columns: id: type: integer(4) primary: true autoincrement: true</p>
</blockquote>
<p>contact\_id: type: integer(4) username: type: string(255) password:
type: string(255) relations: Contact: foreignType: one</p>
<p>Contact: columns: id: type: integer(4) primary: true autoincrement: true
name: type: string(255)</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">一対多<i class="fas fa-link"></i></a></h2>
<blockquote><p>User: columns: id: type: integer(4) primary: true autoincrement: true</p>
</blockquote>
<p>contact\_id: type: integer(4) username: type: string(255) password:
type: string(255)</p>
<p>Phonenumber: columns: id: type: integer(4) primary: true autoincrement:
true name: type: string(255) user\_id: type: integer(4) relations: User:
foreignAlias: Phonenumbers</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">多対多<i class="fas fa-link"></i></a></h2>
<blockquote><p>User: columns: id: type: integer(4) autoincrement: true primary: true</p>
</blockquote>
<p>username: type: string(255) password: type: string(255) attributes:
export: all validate: true</p>
<p>Group: tableName: group\_table columns: id: type: integer(4)
autoincrement: true primary: true name: type: string(255) relations:
Users: foreignAlias: Groups class: User refClass: GroupUser</p>
<p>GroupUser: columns: group\_id: type: integer(4) primary: true user\_id:
type: integer(4) primary: true relations: Group: foreignAlias:
GroupUsers User: foreignAlias: GroupUsers</p>
<p>この場合<code>User</code>は複数の<code>Groups</code>を持ち、<code>Group</code>は複数の<code>Users</code>を持ち、<code>GroupUser</code>は1つの<code>User</code>を持ち<code>GroupUser</code>は1つの<code>Group</code>を持つモデルのセットが作られます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">機能と例<i class="fas fa-link"></i></a></h1>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">接続バインディング<i class="fas fa-link"></i></a></h2>
<p>モデルを管理するためにスキーマファイルを使わないのであれば、通常は次のコードのようにコンポーネントを接続名にバインドするために使います:</p>
<p>下記のように接続を作成します:</p>
<p>Doctrine\_Manager::connection('mysql://jwage:pass@localhost/connection1',
'connection1');</p>
<p>Doctrineのブートストラップスクリプトでモデルをその接続にバインドします:</p>
<blockquote><p>Doctrine\_Manager::connection()-&gt;bindComponent('User', 'conn1');</p>
</blockquote>
<p>スキーマファイルは接続パラメータを指定することでこれを特定の接続にバインドする機能を提供します。接続を指定しなければモデルは<code>Doctrine_Manager</code>インスタンスにセットあれた現在の接続を使います。</p>
<blockquote><p>User: connection: connection1 columns: id: type: integer(4) primary:</p>
</blockquote>
<p>true autoincrement: true contact\_id: type: integer(4) username: type:
string(255) password: type: string(255)</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">属性<i class="fas fa-link"></i></a></h2>
<p>Doctrine\_Record子クラスを手作業で書いたのと同じようにDoctrineはスキーマファイルで生成モデル用の属性を直接設定する手段を提供します。</p>
<blockquote><p>User: connection: connection1 columns: id: type: integer(4) primary:</p>
</blockquote>
<p>true autoincrement: true contact\_id: type: integer(4) username: type:
string(255) password: type: string(255) attributes: export: none
validate: false</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">列挙型<i class="fas fa-link"></i></a></h2>
<p>スキーマファイルでenumカラムを使うために型をenumとして指定し可能なenumの値として値の配列を指定しなければなりません。</p>
<blockquote><p>TvListing: tableName: tv\_listing actAs: [Timestampable] columns:</p>
</blockquote>
<p>notes: type: string taping: type: enum length: 4 values: ['live',
'tape'] region: type: enum length: 4 values: ['US', 'CA']</p>
<hr />
<a class="section-anchor" id="actas" name="actas"></a><h2 class="section-header"><a href="#actas">ActAsビヘイビア<i class="fas fa-link"></i></a></h2>
<p><code>actAs</code>オプションでモデルにビヘイビアを取り付けることができます:</p>
<blockquote><p>User: connection: connection1 columns: id: type: integer(4) primary:</p>
</blockquote>
<p>true autoincrement: true contact\_id: type: integer(4) username: type:
string(255) password: type: string(255) actAs: Timestampable: Sluggable:
fields: [username] name: slug # defaults to 'slug' type: string #
defaults to 'clob' length: 255 # defaults to null. clob doesn't require
a length</p>
<blockquote><p><strong>NOTE</strong>
何も指定しない場合デフォルトの値が使われるのでSluggableビヘイビアで指定されたオプションはオプションです。これらはデフォルトなので毎回入力する必要はありません。</p>
<p>r: connection: connection1 columns: # ... actAs: [Timestampable,</p>
</blockquote>
<p>Sluggable]</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">リスナー<i class="fas fa-link"></i></a></h2>
<p>モデルに取り付けたいリスナーがある場合、同じようにYAMLファイルで直接これらを指定できます。</p>
<blockquote><p>User: listeners: [ MyCustomListener ] columns: id: type: integer(4)</p>
</blockquote>
<p>primary: true autoincrement: true contact\_id: type: integer(4)
username: type: string(255) password: type: string(255)</p>
<p>上記の構文で次のような基底クラスが生成されます:</p>
<blockquote><p>class BaseUser extends Doctrine\_Record { // ...</p>
</blockquote>
<p>public setUp() { // ... $this-&gt;addListener(new MyCustomListener()); } }</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">オプション<i class="fas fa-link"></i></a></h2>
<p>テーブル用のオプションを指定するとDoctrineがモデルからテーブルを作成するときにオプションはcreate
tableステートメントに設定されます。</p>
<blockquote><p>User: connection: connection1 columns: id: type: integer(4) primary:</p>
</blockquote>
<p>true autoincrement: true contact\_id: type: integer(4) username: type:
string(255) password: type: string(255) options: type: INNODB collate:
utf8\_unicode\_ci charset: utf8</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">インデックス<i class="fas fa-link"></i></a></h2>
<p>インデックスとオプションの詳細情報は[doc defining-models chapter]の[doc
defining-models:indexes
:name]セクションを参照してくださるようお願いします。</p>
<blockquote><p>UserProfile: columns: user\_id: type: integer length: 4 primary: true</p>
</blockquote>
<p>autoincrement: true first\_name: type: string length: 20 last\_name:
type: string length: 20 indexes: name\_index: fields: first\_name:
sorting: ASC length: 10 primary: true last\_name: [] type: unique</p>
<p>インデックスの定義用のモデルクラスの<code>setTableDefinition()</code>で自動生成されたPHPコードは次の通りです:</p>
<blockquote><p>$this-&gt;index('name\_index', array( 'fields' =&gt; array( 'first\_name' =&gt;</p>
</blockquote>
<p>array( 'sorting' =&gt; 'ASC',
 'length' =&gt; '10', 'primary' =&gt; true ), 'last\_name' =&gt; array()), 'type'
=&gt; 'unique' ) );</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">継承<i class="fas fa-link"></i></a></h2>
<p>下記のコードはYAMLスキーマファイルを使用して異なるタイプの継承をセットアップする方法を示しています。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h3 class="section-header"><a href="#">単一継承<i class="fas fa-link"></i></a></h3>
<blockquote><p>Entity: columns: name: string(255) username: string(255) password:</p>
</blockquote>
<p>string(255)</p>
<p>User: inheritance: extends: Entity type: simple</p>
<p>Group: inheritance: extends: Entity type: simple</p>
<blockquote><p><strong>NOTE</strong>
単一継承するモデルで定義されたカラムもしくはリレーションはPHPクラスが生成されたときに親に移動します。</p>
</blockquote>
<p>[doc inheritance:simple
:fullname]の章でこのトピックの詳細を読むことができます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h3 class="section-header"><a href="#">具象継承<i class="fas fa-link"></i></a></h3>
<blockquote><p>TextItem: columns: topic: string(255)</p>
</blockquote>
<p>Comment: inheritance: extends: TextItem type: concrete columns: content:
string(300)</p>
<p>[doc inheritance:concrete
:fullname]の章でこのトピックの詳細を読むことができます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h3 class="section-header"><a href="#">カラム集約継承<i class="fas fa-link"></i></a></h3>
<blockquote><p><strong>NOTE</strong>
単一継承のように、PHPクラスが生成されたとき子に追加されるカラムもしくはリレーションは自動的に削除され親に移動します。</p>
</blockquote>
<p>他のモデルが継承する<code>Entity</code>という名前のモデルを定義しましょう:</p>
<blockquote><p>Entity: columns: name: string(255) type: string(255)</p>
<blockquote><p><strong>NOTE</strong>
typeカラムはオプションです。このカラムは子クラスで指定された場合自動的に追加されます。</p>
</blockquote>
</blockquote>
<p><code>Entity</code>モデルを継承する<code>User</code>モデルを作りましょう:</p>
<blockquote><p>User: inheritance: extends: Entity type: column\_aggregation keyField:</p>
</blockquote>
<p>type keyValue: User columns: username: string(255) password: string(255)</p>
<blockquote><p><strong>NOTE</strong>
<code>inheritance</code>定義の下の<code>type</code>オプションは<code>keyField</code>もしくは<code>keyValue</code>を指定する場合暗示されるのでオプションです。<code>keyField</code>が指定されない場合デフォルトでは<code>type</code>という名前のカラムが追加されます。何も指定しない場合デフォルトで<code>keyValue</code>がモデルの名前になります。</p>
</blockquote>
<p>再度<code>Entity</code>を継承する<code>Group</code>という名前の別のモデルを作りましょう:</p>
<blockquote><p>Group: inheritance: extends: Entity type: column\_aggregation keyField:</p>
</blockquote>
<p>type keyValue: Group columns: description: string(255)</p>
<blockquote><p><strong>NOTE</strong>
<code>User</code>の<code>username</code>と<code>password</code>と<code>Group</code>の<code>description</code>カラムは自動的に親の<code>Entity</code>に移動します。</p>
</blockquote>
<p>[doc inheritance:column-aggregation
:fullname]で詳細トピックを読むことができます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">カスタムのエイリアス<i class="fas fa-link"></i></a></h2>
<p>データベースのカラム名以外のカラム名のエイリアスを作成したい場合、Doctrineでこれを実現するのは簡単です。カラムの名前で&quot;<code>column\_name
as field\_name</code>&quot;の構文を使います:</p>
<blockquote><p>User: columns: login: name: login as username type: string(255)</p>
</blockquote>
<p>password: type: string(255)</p>
<p>上記の例では<code>username</code>エイリアスからカラム名の<code>login</code>にアクセスできます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">パッケージ<i class="fas fa-link"></i></a></h2>
<p>Doctrineはサブフォルダでモデルを生成する&quot;package&quot;パラメータを提供します。大きなスキーマファイルによってフォルダの内外でスキーマをよりよく編成できます。</p>
<blockquote><p>User: package: User columns: username: string(255)</p>
</blockquote>
<p>このスキーマファイルからのモデルファイルはUserという名前のフォルダに設置されます。&quot;package:
User.Models&quot;とさらにサブフォルダを指定すればモデルはUser/Modelsになります。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h3 class="section-header"><a href="#">カスタムパスのパッケージ<i class="fas fa-link"></i></a></h3>
<p>パッケージファイルを生成する完全なカスタムパスを指定することで適切なパスでパッケージを自動生成することもできます:</p>
<blockquote><p>User: package: User package\_custom\_path: /path/to/generate/package</p>
</blockquote>
<p>columns: username: string(255)</p>
<hr />
<a class="section-anchor" id="" name=""></a><h2 class="section-header"><a href="#">グローバルスキーマの情報<i class="fas fa-link"></i></a></h2>
<p>Doctrineスキーマによってスキーマファイルで定義されたすべてのモデルに適用する特定のパラメータを指定できます。スキーマファイル用に設定できるグローバルパラメータの例が見つかります。</p>
<p>グローバルパラメータのリストは次の通りです:</p>
<p>\&nbsp; 名前 \&nbsp; 説明 \ \ <code>connection</code> \
モデルをバインドする接続名。 \ \ <code>attributes</code> \
モデル用の属性の配列 \ \ <code>actAs</code> \ モデル用のビヘイビアの配列
\ \ <code>options</code> \ モデル用のテーブルオプションの配列 \ \
<code>package</code> \ モデルを設置するパッケージ \ \ <code>inheritance</code>
\ モデル用の継承情報の配列 \ \ <code>detect_relations</code> \
外部キーのリレーションを検出するかどうか \</p>
<p>上記のグローバルパラメータをいつか使ったスキーマの例は次の通りです:</p>
<blockquote><p>connection: conn\_name1 actAs: [Timestampable] options: type: INNODB</p>
</blockquote>
<p>package: User detect\_relations: true</p>
<p>User: columns: id: type: integer(4) primary: true autoincrement: true
contact\_id: type: integer(4) username: type: string(255) password:
type: string(255)</p>
<p>Contact: columns: id: type: integer(4) primary: true autoincrement: true
name: type: string(255)</p>
<p>トップレベルのすべての設定はYAMLで定義されたすべてのモデルに適用されます。</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">スキーマファイルを使う<i class="fas fa-link"></i></a></h1>
<p>一旦スキーマファイルを定義したらYAMLの定義からモデルをビルドするコードが必要です。</p>
<blockquote><p>$options = array( 'packagesPrefix' =&gt; 'Plugin', 'baseClassName' =&gt;</p>
</blockquote>
<p>'MyDoctrineRecord', 'suffix' =&gt; '.php' );</p>
<p>Doctrine\_Core::generateModelsFromYaml('/path/to/yaml',
'/path/to/model', $options);</p>
<p>上記のコードは<code>/path/to/generate/models</code>の<code>schema.yml</code>用のモデルを生成します。</p>
<p>モデルのビルド方法をカスタマイズするために利用できる異なるオプションの表は次の通りです。<code>packagesPrefix</code>、<code>baseClassName</code>と<code>suffix</code>オプションを使用していることに注目してください。</p>
<p>\&nbsp; 名前 \&nbsp; デフォルト \&nbsp; 説明 \ \ <code>packagesPrefix</code> \
<code>Package</code> \ ミドルパッケージモデルのプレフィックス \ \
<code>packagesPath</code> \ <code>#models_path#/packages</code> \
パッケージファイルを書き込むパス \ \ <code>packagesFolderName</code> \
<code>packages</code> \ パッケージパス内部で、パッケージを置くフォルダーの名前
\ \ <code>generateBaseClasses</code> \ <code>true</code> \
定義と空の基底モデルを継承するトップレベルのクラスを含めて抽象基底モデルを生成するかどうか
\ \ <code>generateTableClasses</code> \ <code>true</code> \
モデルごとにテーブルを生成するか \ \ <code>baseClassPrefix</code> \
<code>Base</code> \ 生成既定モデルに使うプレフィックス \ \
<code>baseClassesDirectory</code> \ <code>generated</code> \
基底クラスの定義を生成するフォルダーの名前 \ \
<code>baseTableClassName</code> \ <code>Doctrine_Table</code> \
ほかの生成テーブルクラス名が継承する基底テーブルクラス \ \
<code>baseClassName</code> \ <code>Doctrine_Record</code> \
Doctrine\_Record既定クラスの名前 \ \ <code>classPrefix</code> \ \
すべての生成クラスで使うプレフィックス \ \ <code>classPrefixFiles</code>
\ <code>true</code> \
生成ファイルの名前にもクラスのプレフィックスを使うかどうか \ \
<code>pearStyle</code> \ <code>false</code> \
PEARスタイルのクラス名とファイルを生成するか。このオプションがtrueにセットされている場合。生成クラスファイルにおいて<code>underscores(\_)</code>は<code>DIRECTORY_SEPARATOR</code>に置き換えられます。\
\ <code>suffix</code> \ <code>.php</code> \ 生成モデルに使う拡張子 \ \
<code>phpDocSubpackage</code> \ \
docブロックで生成するphpDocのサブパッケージ名 \ \ <code>phpDocName</code>
\ \ docブロックで生成するphpDocの著者名 \ \ <code>phpDocEmail</code>
\ \ docブロックで生成するphpDocのメール \</p>
<hr />
<a class="section-anchor" id="" name=""></a><h1 class="section-header"><a href="#">まとめ<i class="fas fa-link"></i></a></h1>
<p>YAMLスキーマファイルのすべてを学んだので[doc data-validation
:name]に関する大きなトピックに移ります。これは重要なトピックです。ユーザーが入力したデータをあなた自身でバリデートしたくない場合データベースに永続的に保存する前にDoctrineにデータをバリデートさせます。</p>
<p></p>
            </main>

        
        <button id="back-to-top" title="Go to top">Top</button>

        <script
          src="https://code.jquery.com/jquery-3.3.1.min.js"
          integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
          crossorigin="anonymous"></script>

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>

        <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0"></script>

        <script id="instantsearch-template" type="text/template">
            
    <a href="{{url}}" class="list-group-item list-group-item-action flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{{_highlightResult.projectName.value}}}: {{{_highlightResult.h1.value}}}</h5>
        </div>

        {{#h2}}
            <p class="mb-1">
                <i class="far fa-arrow-alt-circle-right text-primary"></i>

                {{{_highlightResult.h2.value}}}

                {{#h3}}
                    > {{{_highlightResult.h3.value}}}
                {{/h3}}

                {{#h4}}
                    > {{{_highlightResult.h4.value}}}
                {{/h4}}

                {{#h5}}
                    > {{{_highlightResult.h5.value}}}
                {{/h5}}
            </p>
        {{/h2}}

        {{#content}}
            <div class="content p-2 rounded" style="background-color: rgba(0,0,0,.125);">
                {{{_highlightResult.content.value}}}
            </div>
        {{/content}}
    </a>

        </script>

        <script src="https://cdn.ravenjs.com/3.24.2/raven.min.js" crossorigin="anonymous"></script>

        <script type="text/javascript">
            Raven.config('https://09ce137590054cfd8f0b7e9324d6ec14@sentry.io/1197701').install()
        </script>

        <script src="https://staging.doctrine-project.org/js/main.js?4138a7"></script>
        <script src="https://staging.doctrine-project.org/js/search.js?493399"></script>

        <script type="text/javascript">
            var projectSlug = '';
            var versionSlug = 'latest';

            var searchBoxSettings = {
                container: '#search-box',
                placeholder: 'Search'
            };

            new Main();

            new Search(projectSlug, versionSlug, searchBoxSettings);

            function googleAnalyticsEvent(eventCategory, eventAction, eventLabel, eventValue, fieldsObject) {
                                console.log(eventCategory, eventAction, eventLabel, eventValue, fieldsObject);
                            }

            function googleTranslateElementInit() {
                $('#google_translate_element').html('');

                new google.translate.TranslateElement(
                    {pageLanguage: 'en'}, 'google_translate_element'
                );

                $('#google_translate_element select').on('change', function() {
                    var language = $('#google_translate_element select option:selected').text();

                    googleAnalyticsEvent('Translate', 'click', language);
                });
            }
        </script>

        <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async></script>

        
        
            </body>
</html>
